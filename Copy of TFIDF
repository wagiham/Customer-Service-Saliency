{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"xx0hi_5nZtBw"},"outputs":[],"source":["#working on TFIDF"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"yX82SYl3Zwxb"},"outputs":[],"source":["#import\n","import pandas as pd\n","import numpy as np\n","import os\n","import matplotlib.pyplot as plt\n","import seaborn as sns\n","#additional packages\n","from sklearn.feature_extraction.text import TfidfVectorizer\n","\n","from sklearn.model_selection import cross_val_score, StratifiedKFold, train_test_split\n","from sklearn.metrics import make_scorer, accuracy_score, precision_score, recall_score, f1_score, roc_auc_score, mean_squared_error, log_loss, confusion_matrix\n","from sklearn.linear_model import LogisticRegression\n","from sklearn.model_selection import GridSearchCV"]},{"cell_type":"code","source":["#load the dataset\n","from google.colab import drive\n","drive.mount('/content/drive')\n","X_test = pd.read_csv('/content/drive/MyDrive/BTAI/tweetsum_test.csv')\n","X_train = pd.read_csv('/content/drive/MyDrive/BTAI/tweetsum_train.csv')\n","X_val = pd.read_csv('/content/drive/MyDrive/BTAI/tweetsum_val.csv')\n","\n","# Function\n","def clean(test,train,val):\n","  # Col for Word Count\n","  train['word_count']=train['sentence'].apply(lambda x:len(x.split()))\n","  test['word_count']=test['sentence'].apply(lambda x:len(x.split()))\n","  val['word_count']=val['sentence'].apply(lambda x:len(x.split()))\n","\n","  #adding a new column to X_train \"is_question\" that flags true for question senteces and false for non-question sentences\n","  question_words = [\"who\", \"what\", \"when\", \"where\", \"why\", \"how\", \"if\"]\n","  train['is_question'] = (train['sentence'].str.endswith('?') | train['sentence'].str.lower().str.contains(fr'\\b(?:{\"|\".join(question_words)})\\b'))\n","  test['is_question'] = (train['sentence'].str.endswith('?') | train['sentence'].str.lower().str.contains(fr'\\b(?:{\"|\".join(question_words)})\\b'))\n","  val['is_question'] = (train['sentence'].str.endswith('?') | train['sentence'].str.lower().str.contains(fr'\\b(?:{\"|\".join(question_words)})\\b'))\n","\n","  # # Drop sender, annot_id, dialog_id, and Unnamed: 0\n","  # train.drop(['sender', 'annot_id', 'dialog_id', 'Unnamed: 0'], axis = 1, inplace = True)\n","  # test.drop(['sender', 'annot_id', 'dialog_id', 'Unnamed: 0'], axis = 1, inplace = True)\n","  # val.drop(['sender', 'annot_id', 'dialog_id', 'Unnamed: 0'], axis = 1, inplace = True)\n","\n","  return test,train,val\n","\n","X_train, X_test, X_val = clean(X_train, X_test, X_val)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"49Dkv0s1dwIU","executionInfo":{"status":"ok","timestamp":1701736081671,"user_tz":300,"elapsed":2320,"user":{"displayName":"Fahad Faruqi","userId":"14658484526879603264"}},"outputId":"4989c687-0ea7-4a2a-f208-85140b7665a9"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}]},{"cell_type":"code","source":["X_val['is_salient'].mean()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Vfo_feLZXrVS","executionInfo":{"status":"ok","timestamp":1701736153817,"user_tz":300,"elapsed":2,"user":{"displayName":"Fahad Faruqi","userId":"14658484526879603264"}},"outputId":"dcb3f942-8c93-46a5-a754-28061a327e22"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.21097111247695144"]},"metadata":{},"execution_count":9}]},{"cell_type":"code","source":["# @Menna- this function can be copied for u to use!\n","\n","#function that uses TFIDF to transform the text data of the sentences and returns the new dataframes\n","def TFIDF(X_test, X_train, X_val):\n","  # Create a TfidfVectorizer object and save it to the variable 'tfidf_vectorizer'\n","  # Create a TfidfVectorizer object\n","  tfidf_vectorizer = TfidfVectorizer(min_df=100)\n","\n","  # Fit the vectorizer to X_train\n","  tfidf_vectorizer.fit(X_train['sentence'])\n","\n","  #print the first 50 items in vocabulary\n","  # print(\"Vocabulary size {0}: \".format(len(tfidf_vectorizer.vocabulary_)))\n","  # print(str(list(tfidf_vectorizer.vocabulary_.items())[0:50])+'\\n')\n","\n","  # Using the fitted vectorizer, transform both the train, test and validation data using the fitted vectorizer\n","  X_train_tfidf = tfidf_vectorizer.transform(X_train['sentence'])\n","  X_test_tfidf = tfidf_vectorizer.transform(X_test['sentence'])\n","  X_val_tfidf = tfidf_vectorizer.transform(X_val['sentence'])\n","\n","  # Create DataFrames for the TF-IDF vectors\n","  X_train_tfidf_df = pd.DataFrame(X_train_tfidf.toarray(), columns=tfidf_vectorizer.get_feature_names_out())\n","  X_test_tfidf_df = pd.DataFrame(X_test_tfidf.toarray(), columns=tfidf_vectorizer.get_feature_names_out())\n","  X_val_tfidf_df = pd.DataFrame(X_val_tfidf.toarray(), columns=tfidf_vectorizer.get_feature_names_out())\n","\n","  # Concatenate the TF-IDF DataFrames with original\n","  X_train_with_tfidf = pd.concat([X_train, X_train_tfidf_df], axis=1)\n","  X_test_with_tfidf = pd.concat([X_test, X_test_tfidf_df], axis=1)\n","  X_val_with_tfidf = pd.concat([X_val, X_val_tfidf_df], axis=1)\n","\n","  #drop the sentence feature- we have the vectorized one now\n","  X_train_with_tfidf = X_train_with_tfidf.drop(\"sentence\", axis='columns')\n","  X_test_with_tfidf = X_test_with_tfidf.drop(\"sentence\", axis='columns')\n","  X_val_with_tfidf = X_val_with_tfidf.drop(\"sentence\", axis='columns')\n","\n","  return X_train_with_tfidf, X_test_with_tfidf, X_val_with_tfidf\n","\n","#you can now use the dataframes with the tfidf features\n","X_train, X_test, X_val = TFIDF(X_test, X_train, X_val)"],"metadata":{"id":"84mzhhdNd-ej"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["X_train.to_csv('X_train_with_tfidf.csv')\n","X_test.to_csv('X_test_with_tfidf.csv')\n","X_val.to_csv('X_val_with_tfidf.csv')"],"metadata":{"id":"xCEymY23LnwE"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["X_train.head()\n","X_test.head()\n","X_val.head()"],"metadata":{"id":"Rldad4S7e2Xc","colab":{"base_uri":"https://localhost:8080/","height":273},"executionInfo":{"status":"ok","timestamp":1701729456874,"user_tz":300,"elapsed":8,"user":{"displayName":"Hanna Elizabeth Martin","userId":"08982508819591720439"}},"outputId":"f0634994-311f-4d95-95b1-1a1827c145ea"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   Unnamed: 0                         dialog_id  annot_id    sender  \\\n","0           0  caae83a2ed59e4959d814ea567980226         0  customer   \n","1           1  caae83a2ed59e4959d814ea567980226         1  customer   \n","2           2  caae83a2ed59e4959d814ea567980226         2  customer   \n","3           3  caae83a2ed59e4959d814ea567980226         0  customer   \n","4           4  caae83a2ed59e4959d814ea567980226         1  customer   \n","\n","   is_salient  word_count  is_question   10   11   15  ...  would  wouldn  \\\n","0        True          15        False  0.0  0.0  0.0  ...    0.0     0.0   \n","1        True          15        False  0.0  0.0  0.0  ...    0.0     0.0   \n","2        True          15        False  0.0  0.0  0.0  ...    0.0     0.0   \n","3       False           2         True  0.0  0.0  0.0  ...    0.0     0.0   \n","4       False           2         True  0.0  0.0  0.0  ...    0.0     0.0   \n","\n","   wrong  xbox  xboxsupport  yes  yesterday  yet  you  your  \n","0    0.0   0.0          0.0  0.0        0.0  0.0  0.0   0.0  \n","1    0.0   0.0          0.0  0.0        0.0  0.0  0.0   0.0  \n","2    0.0   0.0          0.0  0.0        0.0  0.0  0.0   0.0  \n","3    0.0   0.0          0.0  0.0        0.0  0.0  0.0   0.0  \n","4    0.0   0.0          0.0  0.0        0.0  0.0  0.0   0.0  \n","\n","[5 rows x 559 columns]"],"text/html":["\n","  <div id=\"df-ad8b7457-6207-4369-bae8-443435eb4372\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Unnamed: 0</th>\n","      <th>dialog_id</th>\n","      <th>annot_id</th>\n","      <th>sender</th>\n","      <th>is_salient</th>\n","      <th>word_count</th>\n","      <th>is_question</th>\n","      <th>10</th>\n","      <th>11</th>\n","      <th>15</th>\n","      <th>...</th>\n","      <th>would</th>\n","      <th>wouldn</th>\n","      <th>wrong</th>\n","      <th>xbox</th>\n","      <th>xboxsupport</th>\n","      <th>yes</th>\n","      <th>yesterday</th>\n","      <th>yet</th>\n","      <th>you</th>\n","      <th>your</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>caae83a2ed59e4959d814ea567980226</td>\n","      <td>0</td>\n","      <td>customer</td>\n","      <td>True</td>\n","      <td>15</td>\n","      <td>False</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>caae83a2ed59e4959d814ea567980226</td>\n","      <td>1</td>\n","      <td>customer</td>\n","      <td>True</td>\n","      <td>15</td>\n","      <td>False</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>caae83a2ed59e4959d814ea567980226</td>\n","      <td>2</td>\n","      <td>customer</td>\n","      <td>True</td>\n","      <td>15</td>\n","      <td>False</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>caae83a2ed59e4959d814ea567980226</td>\n","      <td>0</td>\n","      <td>customer</td>\n","      <td>False</td>\n","      <td>2</td>\n","      <td>True</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>caae83a2ed59e4959d814ea567980226</td>\n","      <td>1</td>\n","      <td>customer</td>\n","      <td>False</td>\n","      <td>2</td>\n","      <td>True</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows Ã— 559 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-ad8b7457-6207-4369-bae8-443435eb4372')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-ad8b7457-6207-4369-bae8-443435eb4372 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-ad8b7457-6207-4369-bae8-443435eb4372');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-24952132-d5a1-4ddb-9b39-f9fcca34895e\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-24952132-d5a1-4ddb-9b39-f9fcca34895e')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-24952132-d5a1-4ddb-9b39-f9fcca34895e button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"]},"metadata":{},"execution_count":4}]},{"cell_type":"code","source":["#Hanna\n","#TFIDF + Logistic Regression\n","from sklearn.linear_model import LogisticRegression\n","from sklearn.model_selection import train_test_split\n","from sklearn.metrics import log_loss\n","from sklearn.metrics import accuracy_score\n","\n","y_train_logreg=X_train[\"is_salient\"]\n","y_test_logreg=X_test[\"is_salient\"]\n","y_val_logreg=X_val[\"is_salient\"]\n","\n","feature_list=list(X_train.select_dtypes(include = ['float64', 'int64']).columns)\n","X_train.head()\n","\n","X_train_logreg=X_train[feature_list]\n","X_test_logreg=X_test[feature_list]\n","X_val_logreg=X_val[feature_list]\n","\n","# apply the dtype attribute\n","result = X_train_logreg.dtypes\n","\n","print(\"Output:\")\n","print(result)\n","\n","print(\"Number of examples: \" + str(X_train.shape[0]))\n","print(\"\\nNumber of Features:\" + str(X_train.shape[1]))\n","print(str(list(X_train.columns)))"],"metadata":{"id":"GhrmQTZoslKr","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1701729457199,"user_tz":300,"elapsed":329,"user":{"displayName":"Hanna Elizabeth Martin","userId":"08982508819591720439"}},"outputId":"6672ddf6-63fb-419b-cd9e-7825ec5eed9a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Output:\n","Unnamed: 0      int64\n","annot_id        int64\n","word_count      int64\n","10            float64\n","11            float64\n","               ...   \n","yes           float64\n","yesterday     float64\n","yet           float64\n","you           float64\n","your          float64\n","Length: 555, dtype: object\n","Number of examples: 51483\n","\n","Number of Features:559\n","['Unnamed: 0', 'dialog_id', 'annot_id', 'sender', 'is_salient', 'word_count', 'is_question', '10', '11', '15', '20', '24', '30', 'able', 'about', 'access', 'account', 'actually', 'add', 'address', 'adobecare', 'advise', 'afraid', 'after', 'again', 'agent', 'ago', 'airasiasupport', 'airport', 'all', 'already', 'also', 'always', 'am', 'amazon', 'amazonhelp', 'americanair', 'amp', 'an', 'and', 'another', 'answer', 'any', 'anything', 'apologies', 'apologize', 'app', 'apple', 'applesupport', 'appreciate', 'are', 'area', 'argoshelpers', 'around', 'as', 'asap', 'ask', 'ask_spectrum', 'askamex', 'askebay', 'asked', 'askplaystation', 'assist', 'assistance', 'asurioncares', 'at', 'atviassist', 'available', 'azuresupport', 'back', 'bag', 'battery', 'be', 'because', 'been', 'before', 'being', 'best', 'better', 'bit', 'book', 'booked', 'booking', 'both', 'bought', 'box', 'british_airways', 'business', 'but', 'button', 'buy', 'by', 'call', 'called', 'can', 'cancel', 'cannot', 'car', 'card', 'care', 'case', 'caused', 'chance', 'change', 'changes', 'charge', 'chat', 'check', 'checked', 'checking', 'claim', 'click', 'co', 'code', 'come', 'company', 'computer', 'concern', 'confirm', 'confirmation', 'connect', 'connection', 'console', 'contact', 'continue', 'correct', 'could', 'couldn', 'credit', 'currently', 'customer', 'customers', 'data', 'date', 'day', 'days', 'delay', 'delayed', 'delivery', 'delta', 'details', 'device', 'devices', 'did', 'didn', 'different', 'direct', 'directly', 'dm', 'do', 'does', 'doesn', 'doing', 'don', 'done', 'down', 'download', 'due', 'earlier', 'else', 'email', 'end', 'error', 'even', 'ever', 'every', 'everything', 'experience', 'extra', 'far', 'feedback', 'feel', 'few', 'find', 'fine', 'first', 'fix', 'fixed', 'flight', 'flights', 'follow', 'following', 'for', 'forward', 'found', 'free', 'from', 'frustrating', 'frustration', 'full', 'further', 'future', 'game', 'gdrqu22ypt', 'get', 'getting', 'give', 'given', 'glad', 'glocare', 'go', 'going', 'good', 'got', 'great', 'gt', 'guys', 'gwrhelp', 'had', 'happen', 'happened', 'happening', 'happens', 'happy', 'hard', 'has', 'have', 'haven', 'having', 'he', 'hear', 'hello', 'help', 'helps', 'here', 'hey', 'hi', 'hold', 'home', 'hope', 'hour', 'hours', 'how', 'however', 'hp', 'https', 'hulu_support', 'idea', 'idea_cares', 'if', 'in', 'inconvenience', 'info', 'information', 'internet', 'into', 'ios', 'iphone', 'is', 'isn', 'issue', 'issues', 'it', 'item', 'items', 'its', 'journey', 'just', 'keep', 'kindly', 'know', 'laptop', 'last', 'late', 'later', 'latest', 'leave', 'left', 'let', 'like', 'line', 'link', 'list', 'live', 'll', 'log', 'london', 'long', 'longer', 'look', 'looking', 'lost', 'love', 'made', 'make', 'manager', 'many', 'marksandspencer', 'matter', 'may', 'maybe', 'me', 'mean', 'message', 'messages', 'microsofthelps', 'might', 'minutes', 'mobile', 'modem', 'money', 'month', 'more', 'morning', 'most', 'move', 'much', 'music', 'my', 'name', 'need', 'network', 'never', 'new', 'next', 'night', 'nikesupport', 'no', 'not', 'nothing', 'now', 'number', 'o2', 'of', 'off', 'offer', 'oh', 'ok', 'okay', 'on', 'once', 'one', 'online', 'only', 'open', 'option', 'options', 'or', 'order', 'other', 'our', 'out', 'over', 'page', 'paid', 'pass', 'patience', 'pay', 'payment', 'pc', 'people', 'phone', 'place', 'play', 'please', 'plus', 'point', 'possible', 'posted', 'power', 'price', 'problem', 'problems', 'process', 'product', 'provide', 'provided', 'purchase', 'put', 'question', 'questions', 're', 'reach', 'really', 'reason', 'receive', 'received', 'recommend', 'refund', 'regarding', 'regards', 'reply', 'report', 'request', 'reset', 'resolve', 'resolved', 'response', 'restarting', 'return', 'review', 'right', 'router', 'run', 'running', 'safaricom_care', 'said', 'sainsburys', 'same', 'say', 'saying', 'says', 'screen', 'screenshot', 'seat', 'seats', 'security', 'see', 'seems', 'seller', 'send', 'sent', 'service', 'services', 'set', 'settings', 'share', 'she', 'should', 'show', 'showing', 'shows', 'since', 'site', 'so', 'some', 'someone', 'something', 'song', 'songs', 'soon', 'sorry', 'southwestair', 'speak', 'specific', 'spotify', 'spotifycares', 'sprintcare', 'staff', 'start', 'station', 'steps', 'still', 'stock', 'store', 'stores', 'suggest', 'support', 'sure', 'sw_help', 'system', 'take', 'team', 'tell', 'tesco', 'than', 'thank', 'thanks', 'that', 'the', 'their', 'them', 'then', 'there', 'these', 'they', 'thing', 'things', 'think', 'this', 'those', 'though', 'through', 'ticket', 'tickets', 'time', 'times', 'tmobilehelp', 'to', 'today', 'told', 'tomorrow', 'too', 'touch', 'train', 'trains', 'travel', 'tried', 'trouble', 'try', 'trying', 'tv', 'tweet', 'twitter', 'two', 'ty', 'unable', 'understand', 'unfortunately', 'until', 'up', 'update', 'updated', 'updates', 'upgrade', 'ur', 'us', 'use', 'used', 'using', 've', 'verizonsupport', 'version', 'very', 'via', 'virgintrains', 'visit', 'wait', 'waiting', 'want', 'was', 'wasn', 'watch', 'way', 'we', 'website', 'week', 'welcome', 'well', 'went', 'were', 'what', 'when', 'where', 'which', 'while', 'who', 'why', 'wifi', 'will', 'windows', 'with', 'within', 'without', 'won', 'work', 'worked', 'working', 'works', 'would', 'wouldn', 'wrong', 'xbox', 'xboxsupport', 'yes', 'yesterday', 'yet', 'you', 'your']\n"]}]},{"cell_type":"code","source":["def train_val_test_LR(X_train, y_train, X_test, y_test, X_val, y_val):\n","  #didnt use validation here- we didnt tune any hyperparams\n","  model=LogisticRegression(C=1)\n","  model.fit(X_train, y_train)\n","  probability_predictions=model.predict_proba(X_test)\n","  l_loss=log_loss(y_test, probability_predictions)\n","  class_label_predictions=model.predict(X_test)\n","\n","  acc_score=accuracy_score(y_test, class_label_predictions)\n","  precision = precision_score(y_test, class_label_predictions)\n","  recall = recall_score(y_test, class_label_predictions)\n","  f1 = f1_score(y_test, class_label_predictions)\n","  roc_auc = roc_auc_score(y_test, probability_predictions[:, 1])\n","\n","  return class_label_predictions,l_loss, acc_score, precision, recall, f1, roc_auc\n","\n","class_label_predictions,loss, acc, precision, recall, f1, roc_auc = train_val_test_LR(X_train_logreg, y_train_logreg, X_test_logreg, y_test_logreg, X_val_logreg, y_val_logreg)\n","print('Log loss: ' + str(loss))\n","#accuracy: percentage of predictions that are correct\n","# (TP+TN)/(TP+TN+FP+FN)\n","print('Accuracy: ' + str(acc))\n","#precision: the percentage of positive(salient) predictions that are correct\n","#the percentage of salient predictions that were actually salient\n","# TP/(TP+FP)\n","print('Precision: ' + str(precision))\n","#recall: the percentage of positive cases that were predicted as positive\n","# the percentage of salient sentences that were predicted as salient\n","# TP/(TP+FN)\n","print('Recall: ' + str(recall))\n","print('F1 Score: ' + str(f1))\n","print('ROC AUC Score: ' + str(roc_auc))\n","print('Class labels: ' + str(class_label_predictions[0:20]))\n","\n","#print out the percentage the model determines an example to be salient\n","#in test data: 19.13% of examples are salient\n","print(np.mean(class_label_predictions))\n","\n","#look into: cross validation vs using our validation data set\n","#cross validation randomization - using seed values between models\n","\n","\n","\n","# Generate the confusion matrix\n","cm = confusion_matrix(y_test_logreg, class_label_predictions)\n","\n","sns.heatmap(cm,\n","            annot=True,\n","            fmt='g',\n","            xticklabels=['Not Salient','Salient'],\n","            yticklabels=['Not Salient','Salient'])\n","plt.xlabel('Predicted')\n","plt.ylabel('True')\n","plt.title('Confusion Matrix')\n","plt.show()\n","\n","print(len(class_label_predictions))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":671},"id":"RC9CgViZbyz0","executionInfo":{"status":"ok","timestamp":1701736241956,"user_tz":300,"elapsed":6192,"user":{"displayName":"Hanna Elizabeth Martin","userId":"08982508819591720439"}},"outputId":"24bc1490-7e63-4bbc-d15f-6018391cd237"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Log loss: 0.4095017620444538\n","Accuracy: 0.8073150224215246\n","Precision: 0.4917218543046358\n","Recall: 0.2175824175824176\n","F1 Score: 0.3016759776536313\n","ROC AUC Score: 0.8160036001657904\n","Class labels: [False False False False False False False False False False False False\n"," False False False False False False False False]\n","0.08464125560538116\n"]},{"output_type":"display_data","data":{"text/plain":["<Figure size 640x480 with 2 Axes>"],"image/png":"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unXrprXAiIiI6L+jQglJcXExhg8fjqZNm8La2lqqmIiIiHSKljZq1WkVmtSqr6+Pbt268a2+REREFVBVdmqtyiq8yqZJkyb46y/u80FERETaU+GEZO7cuQgODsaePXuQmpqK7OxstYOIiIjUCYJCK4cuK/ccktDQUEyYMAHvvvsuAKBXr15qW8gLggCFQoHi4mLtR0lERPQKU8kdwCug3AnJ7NmzMWbMGBw5ckTKeIiIiOg/qNwJSckrbzp27ChZMERERLpIgG4Pt2hDhZb9/tNbfomIiKhsKq771ahCCUmDBg00JiUPHjz4VwERERHpGhV7SDSqUEIye/bsUju1EhEREf1bFUpIfH19YWtrK1UsREREOolzSDQrd0LC+SNEREQvh8t+NSv3xmglq2yIiIiItK3cPSQqFfM7IiKil8EhG80qNIeEiIiIKo7/pNeswu+yISIiItI29pAQERFJjD0kmjEhISIikhjnkGjGIRsiIiKSHXtIiIiIJKZiB4lGTEiIiIgkxnfZaMaEhIiISGLcWlQzziEhIiIi2bGHhIiISGJc9qsZExIiIiKJqfiCWo04ZENERESyYw8JERGRxDipVTMmJERERBLjHBLNOGRDREREsmMPCRERkcS4U6tmTEiIiIgkxp1aNeOQDREREcmOPSREREQS4yobzZiQEBERSYxzSDRjQkJERCQxLvvVjHNIiIiISHbsISEiIpIY55BoxoSEiIhIYpxDohmHbIiIiEh27CEhIiKSGCe1asaEhIiISGJMSDTjkA0RERHJjj0kREREEhM4qVUjJiREREQS45CNZhyyISIiItmxh4SIiEhi7CHRjAkJERGRxLhTq2ZMSIiIiCTGnVo14xwSIiIikh17SIiIiCTGOSSaMSEhIiKSGBMSzThkQ0RERLJjDwkREZHEuMpGMyYkREREEuMqG804ZENERESyYw8JERGRxDipVTP2kBAREUlM0NJREWFhYXjjjTdgbm4OW1tb9OnTB4mJiWp18vLyEBAQgOrVq8PMzAz9+vVDenq6Wp3k5GT4+PjAxMQEtra2mDhxIoqKitTqHD16FB4eHlAqlXB1dUVEREQFo2VCQkREpJOOHTuGgIAAnDp1CgcPHkRhYSG6deuGx48fi3UCAwOxe/dubN26FceOHUNKSgr69u0rni8uLoaPjw8KCgpw8uRJREZGIiIi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\n"},"metadata":{}},{"output_type":"stream","name":"stdout","text":["7136\n"]}]},{"cell_type":"code","source":["#tuning hyperparam C - use validation for this\n","def train_test_val_LR(X_train, y_train, X_test, y_test, X_val, y_val):\n","  param_grid = {'C': [0.1, 1, 10]}\n","  model=LogisticRegression()\n","  grid_search = GridSearchCV(model, param_grid, cv=5, scoring='f1')\n","  grid_search.fit(X_val, y_val)\n","  best_C = grid_search.best_params_['C']\n","  print(best_C)\n","  best_model = LogisticRegression(C=best_C)\n","  best_model.fit(X_train, y_train)\n","  probability_predictions=best_model.predict_proba(X_test)\n","  l_loss=log_loss(y_test, probability_predictions)\n","  class_label_predictions=best_model.predict(X_test)\n","\n","\n","  acc_score=accuracy_score(y_test, class_label_predictions)\n","  precision = precision_score(y_test, class_label_predictions)\n","  recall = recall_score(y_test, class_label_predictions)\n","  f1 = f1_score(y_test, class_label_predictions)\n","  roc_auc = roc_auc_score(y_test, probability_predictions[:, 1])\n","\n","  return class_label_predictions,l_loss, acc_score, precision, recall, f1, roc_auc\n","\n","class_label_predictions,loss, acc, precision, recall, f1, roc_auc = train_test_val_LR(X_train_logreg, y_train_logreg, X_test_logreg, y_test_logreg, X_test_logreg, y_test_logreg)\n","print('Log loss: ' + str(loss))\n","print('Accuracy: ' + str(acc))\n","print('Precision: ' + str(precision))\n","print('Recall: ' + str(recall))\n","print('F1 Score: ' + str(f1))\n","print('ROC AUC Score: ' + str(roc_auc))\n","print('Class labels: ' + str(class_label_predictions[0:20]))\n"],"metadata":{"id":"Y78bIqJSgK0S","executionInfo":{"status":"ok","timestamp":1701711534640,"user_tz":300,"elapsed":0,"user":{"displayName":"Hanna Elizabeth Martin","userId":"08982508819591720439"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"f1c8e88c-8b1c-496d-b11e-09b538f60447"},"execution_count":null,"outputs":[{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.10/dist-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):\n","STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n","\n","Increase the number of iterations (max_iter) or scale the data as shown in:\n","    https://scikit-learn.org/stable/modules/preprocessing.html\n","Please also refer to the documentation for alternative solver options:\n","    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n","  n_iter_i = _check_optimize_result(\n","/usr/local/lib/python3.10/dist-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):\n","STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n","\n","Increase the number of iterations (max_iter) or scale the data as shown in:\n","    https://scikit-learn.org/stable/modules/preprocessing.html\n","Please also refer to the documentation for alternative solver options:\n","    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n","  n_iter_i = _check_optimize_result(\n","/usr/local/lib/python3.10/dist-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):\n","STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n","\n","Increase the number of iterations (max_iter) or scale the data as shown in:\n","    https://scikit-learn.org/stable/modules/preprocessing.html\n","Please also refer to the documentation for alternative solver options:\n","    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n","  n_iter_i = _check_optimize_result(\n","/usr/local/lib/python3.10/dist-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):\n","STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n","\n","Increase the number of iterations (max_iter) or scale the data as shown in:\n","    https://scikit-learn.org/stable/modules/preprocessing.html\n","Please also refer to the documentation for alternative solver options:\n","    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n","  n_iter_i = _check_optimize_result(\n"]},{"metadata":{"tags":null},"name":"stdout","output_type":"stream","text":["1\n","Log loss: 0.4095017620444538\n","Accuracy: 0.8073150224215246\n","Precision: 0.4917218543046358\n","Recall: 0.2175824175824176\n","F1 Score: 0.3016759776536313\n","ROC AUC Score: 0.8160036001657904\n","Class labels: [False False False False False False False False False False False False\n"," False False False False False False False False]\n"]}]},{"cell_type":"code","source":[],"metadata":{"id":"OGYnqaTCgonJ","colab":{"base_uri":"https://localhost:8080/","height":250},"executionInfo":{"status":"error","timestamp":1701729470149,"user_tz":300,"elapsed":326,"user":{"displayName":"Hanna Elizabeth Martin","userId":"08982508819591720439"}},"outputId":"3bf553ab-f35b-464f-da51-2b719fb99177"},"execution_count":null,"outputs":[{"output_type":"error","ename":"NameError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-7-0e076bc525ce>\u001b[0m in \u001b[0;36m<cell line: 2>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0;31m# Generate the confusion matrix\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 2\u001b[0;31m \u001b[0mcm\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mconfusion_matrix\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0my_test\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mclass_label_predictions\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      3\u001b[0m \u001b[0mcm\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mconfusion_matrix\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0my_test\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mclass_label_predictions\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m sns.heatmap(cm,\n","\u001b[0;31mNameError\u001b[0m: name 'y_test' is not defined"]}]},{"cell_type":"code","source":[],"metadata":{"id":"MwQFiVHu4N3W"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"provenance":[{"file_id":"1fmcf0zGQNfP0ag3X2FjSadJqz4oDbjOl","timestamp":1701813538195}]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}