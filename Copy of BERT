{"cells":[{"cell_type":"markdown","metadata":{"id":"sRosMJCmvCOy"},"source":["# Generic Model Training\n","The code below sets up and trains a simple model"]},{"cell_type":"markdown","metadata":{"id":"cMbI_20dBGTW"},"source":["<h1>Experimental Word Vectorization Problem</h1>"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":38717,"status":"ok","timestamp":1699731200764,"user":{"displayName":"Saadman Khan","userId":"18161026206221029184"},"user_tz":300},"id":"rZ-wnFeBdslv","outputId":"50265525-1ab3-419a-8700-2c847293625d"},"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: transformers in /usr/local/lib/python3.10/dist-packages (4.35.0)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers) (3.13.1)\n","Requirement already satisfied: huggingface-hub<1.0,>=0.16.4 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.17.3)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (1.23.5)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from transformers) (23.2)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from transformers) (6.0.1)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (2023.6.3)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from transformers) (2.31.0)\n","Requirement already satisfied: tokenizers<0.15,>=0.14 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.14.1)\n","Requirement already satisfied: safetensors>=0.3.1 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.4.0)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.10/dist-packages (from transformers) (4.66.1)\n","Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.16.4->transformers) (2023.6.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.16.4->transformers) (4.5.0)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (3.4)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2023.7.22)\n","Requirement already satisfied: tensorflow-text in /usr/local/lib/python3.10/dist-packages (2.14.0)\n","Requirement already satisfied: tensorflow-hub>=0.13.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow-text) (0.15.0)\n","Requirement already satisfied: tensorflow<2.15,>=2.14.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow-text) (2.14.0)\n","Requirement already satisfied: absl-py>=1.0.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (1.4.0)\n","Requirement already satisfied: astunparse>=1.6.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (1.6.3)\n","Requirement already satisfied: flatbuffers>=23.5.26 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (23.5.26)\n","Requirement already satisfied: gast!=0.5.0,!=0.5.1,!=0.5.2,>=0.2.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (0.4.0)\n","Requirement already satisfied: google-pasta>=0.1.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (0.2.0)\n","Requirement already satisfied: h5py>=2.9.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (3.9.0)\n","Requirement already satisfied: libclang>=13.0.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (16.0.6)\n","Requirement already satisfied: ml-dtypes==0.2.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (0.2.0)\n","Requirement already satisfied: numpy>=1.23.5 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (1.23.5)\n","Requirement already satisfied: opt-einsum>=2.3.2 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (3.3.0)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (23.2)\n","Requirement already satisfied: protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (3.20.3)\n","Requirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (67.7.2)\n","Requirement already satisfied: six>=1.12.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (1.16.0)\n","Requirement already satisfied: termcolor>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (2.3.0)\n","Requirement already satisfied: typing-extensions>=3.6.6 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (4.5.0)\n","Requirement already satisfied: wrapt<1.15,>=1.11.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (1.14.1)\n","Requirement already satisfied: tensorflow-io-gcs-filesystem>=0.23.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (0.34.0)\n","Requirement already satisfied: grpcio<2.0,>=1.24.3 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (1.59.2)\n","Requirement already satisfied: tensorboard<2.15,>=2.14 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (2.14.1)\n","Requirement already satisfied: tensorflow-estimator<2.15,>=2.14.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (2.14.0)\n","Requirement already satisfied: keras<2.15,>=2.14.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (2.14.0)\n","Requirement already satisfied: wheel<1.0,>=0.23.0 in /usr/local/lib/python3.10/dist-packages (from astunparse>=1.6.0->tensorflow<2.15,>=2.14.0->tensorflow-text) (0.41.3)\n","Requirement already satisfied: google-auth<3,>=1.6.3 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (2.17.3)\n","Requirement already satisfied: google-auth-oauthlib<1.1,>=0.5 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (1.0.0)\n","Requirement already satisfied: markdown>=2.6.8 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (3.5.1)\n","Requirement already satisfied: requests<3,>=2.21.0 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (2.31.0)\n","Requirement already satisfied: tensorboard-data-server<0.8.0,>=0.7.0 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (0.7.2)\n","Requirement already satisfied: werkzeug>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (3.0.1)\n","Requirement already satisfied: cachetools<6.0,>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from google-auth<3,>=1.6.3->tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (5.3.2)\n","Requirement already satisfied: pyasn1-modules>=0.2.1 in /usr/local/lib/python3.10/dist-packages (from google-auth<3,>=1.6.3->tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (0.3.0)\n","Requirement already satisfied: rsa<5,>=3.1.4 in /usr/local/lib/python3.10/dist-packages (from google-auth<3,>=1.6.3->tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (4.9)\n","Requirement already satisfied: requests-oauthlib>=0.7.0 in /usr/local/lib/python3.10/dist-packages (from google-auth-oauthlib<1.1,>=0.5->tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (1.3.1)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (3.4)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (2023.7.22)\n","Requirement already satisfied: MarkupSafe>=2.1.1 in /usr/local/lib/python3.10/dist-packages (from werkzeug>=1.0.1->tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (2.1.3)\n","Requirement already satisfied: pyasn1<0.6.0,>=0.4.6 in /usr/local/lib/python3.10/dist-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (0.5.0)\n","Requirement already satisfied: oauthlib>=3.0.0 in /usr/local/lib/python3.10/dist-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<1.1,>=0.5->tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (3.2.2)\n","Requirement already satisfied: tensorflow in /usr/local/lib/python3.10/dist-packages (2.14.0)\n","Requirement already satisfied: absl-py>=1.0.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.4.0)\n","Requirement already satisfied: astunparse>=1.6.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.6.3)\n","Requirement already satisfied: flatbuffers>=23.5.26 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (23.5.26)\n","Requirement already satisfied: gast!=0.5.0,!=0.5.1,!=0.5.2,>=0.2.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (0.4.0)\n","Requirement already satisfied: google-pasta>=0.1.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (0.2.0)\n","Requirement already satisfied: h5py>=2.9.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (3.9.0)\n","Requirement already satisfied: libclang>=13.0.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (16.0.6)\n","Requirement already satisfied: ml-dtypes==0.2.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (0.2.0)\n","Requirement already satisfied: numpy>=1.23.5 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.23.5)\n","Requirement already satisfied: opt-einsum>=2.3.2 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (3.3.0)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from tensorflow) (23.2)\n","Requirement already satisfied: protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (3.20.3)\n","Requirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from tensorflow) (67.7.2)\n","Requirement already satisfied: six>=1.12.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.16.0)\n","Requirement already satisfied: termcolor>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (2.3.0)\n","Requirement already satisfied: typing-extensions>=3.6.6 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (4.5.0)\n","Requirement already satisfied: wrapt<1.15,>=1.11.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.14.1)\n","Requirement already satisfied: tensorflow-io-gcs-filesystem>=0.23.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (0.34.0)\n","Requirement already satisfied: grpcio<2.0,>=1.24.3 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (1.59.2)\n","Requirement already satisfied: tensorboard<2.15,>=2.14 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (2.14.1)\n","Requirement already satisfied: tensorflow-estimator<2.15,>=2.14.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (2.14.0)\n","Requirement already satisfied: keras<2.15,>=2.14.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow) (2.14.0)\n","Requirement already satisfied: wheel<1.0,>=0.23.0 in /usr/local/lib/python3.10/dist-packages (from astunparse>=1.6.0->tensorflow) (0.41.3)\n","Requirement already satisfied: google-auth<3,>=1.6.3 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.15,>=2.14->tensorflow) (2.17.3)\n","Requirement already satisfied: google-auth-oauthlib<1.1,>=0.5 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.15,>=2.14->tensorflow) (1.0.0)\n","Requirement already satisfied: markdown>=2.6.8 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.15,>=2.14->tensorflow) (3.5.1)\n","Requirement already satisfied: requests<3,>=2.21.0 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.15,>=2.14->tensorflow) (2.31.0)\n","Requirement already satisfied: tensorboard-data-server<0.8.0,>=0.7.0 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.15,>=2.14->tensorflow) (0.7.2)\n","Requirement already satisfied: werkzeug>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.15,>=2.14->tensorflow) (3.0.1)\n","Requirement already satisfied: cachetools<6.0,>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from google-auth<3,>=1.6.3->tensorboard<2.15,>=2.14->tensorflow) (5.3.2)\n","Requirement already satisfied: pyasn1-modules>=0.2.1 in /usr/local/lib/python3.10/dist-packages (from google-auth<3,>=1.6.3->tensorboard<2.15,>=2.14->tensorflow) (0.3.0)\n","Requirement already satisfied: rsa<5,>=3.1.4 in /usr/local/lib/python3.10/dist-packages (from google-auth<3,>=1.6.3->tensorboard<2.15,>=2.14->tensorflow) (4.9)\n","Requirement already satisfied: requests-oauthlib>=0.7.0 in /usr/local/lib/python3.10/dist-packages (from google-auth-oauthlib<1.1,>=0.5->tensorboard<2.15,>=2.14->tensorflow) (1.3.1)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorboard<2.15,>=2.14->tensorflow) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorboard<2.15,>=2.14->tensorflow) (3.4)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorboard<2.15,>=2.14->tensorflow) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorboard<2.15,>=2.14->tensorflow) (2023.7.22)\n","Requirement already satisfied: MarkupSafe>=2.1.1 in /usr/local/lib/python3.10/dist-packages (from werkzeug>=1.0.1->tensorboard<2.15,>=2.14->tensorflow) (2.1.3)\n","Requirement already satisfied: pyasn1<0.6.0,>=0.4.6 in /usr/local/lib/python3.10/dist-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard<2.15,>=2.14->tensorflow) (0.5.0)\n","Requirement already satisfied: oauthlib>=3.0.0 in /usr/local/lib/python3.10/dist-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<1.1,>=0.5->tensorboard<2.15,>=2.14->tensorflow) (3.2.2)\n"]}],"source":["#Install Libraries\n","!pip install -q tensorflow bert-for-tf2 tokenizers\n","!pip install transformers\n","!pip install tensorflow-text\n","!pip install tensorflow"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":144},"executionInfo":{"elapsed":133,"status":"error","timestamp":1699730976478,"user":{"displayName":"Saadman Khan","userId":"18161026206221029184"},"user_tz":300},"id":"fRop2GsoeCLz","outputId":"2e5ac2d1-fd55-45ba-ee04-e97ebea5bc8d"},"outputs":[{"output_type":"error","ename":"IndentationError","evalue":"ignored","traceback":["\u001b[0;36m  File \u001b[0;32m\"<ipython-input-13-6a94d73564d4>\"\u001b[0;36m, line \u001b[0;32m5\u001b[0m\n\u001b[0;31m    except ImportError:\u001b[0m\n\u001b[0m    ^\u001b[0m\n\u001b[0;31mIndentationError\u001b[0m\u001b[0;31m:\u001b[0m expected an indented block after 'try' statement on line 2\n"]}],"source":["#Check Libraries Installed\n","try:\n","    #import bert\n","    #print(f\"{bert} is installed.\")\n","except ImportError:\n","    print(f\"{bert} is not installed.\")\n","from transformers import pipeline"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"a8Hou1LxjjWn"},"outputs":[],"source":["import tensorflow as tf\n","import tensorflow_hub as hub\n","#from tf import tensorflow_text as text\n","# from bert import tokenization\n","#import bert\n","import pandas as pd\n","\n","import tensorflow as tf\n","import tensorflow_hub as hub\n","from keras.utils import to_categorical\n","from sklearn import preprocessing\n","import os\n","for dirname, _, filenames in os.walk('/kaggle/input'):\n","    for filename in filenames:\n","        print(os.path.join(dirname, filename))\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2483,"status":"ok","timestamp":1699730987484,"user":{"displayName":"Saadman Khan","userId":"18161026206221029184"},"user_tz":300},"id":"MQYLJV0bZmHj","outputId":"2952cbce-d0c0-4260-a74f-8286f31d3f33"},"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}],"source":["# Import Data\n","from google.colab import drive\n","drive.mount('/content/drive')\n","X_test = pd.read_csv('/content/drive/MyDrive/BTAI/tweetsum_test.csv')\n","X_train = pd.read_csv('/content/drive/MyDrive/BTAI/tweetsum_train.csv')\n","X_val = pd.read_csv('/content/drive/MyDrive/BTAI/tweetsum_val.csv')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":118,"status":"ok","timestamp":1699730990920,"user":{"displayName":"Saadman Khan","userId":"18161026206221029184"},"user_tz":300},"id":"yut0NMNRmnbz","outputId":"be573e0b-0182-41e4-ffc9-815af87dbf7b"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["Index(['Unnamed: 0', 'dialog_id', 'annot_id', 'sender', 'sentence',\n","       'is_salient'],\n","      dtype='object')"]},"metadata":{},"execution_count":16}],"source":["X_train.columns"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":138,"status":"ok","timestamp":1699730999355,"user":{"displayName":"Saadman Khan","userId":"18161026206221029184"},"user_tz":300},"id":"WF5AsWgBqtWf","outputId":"20a2831c-cc04-4c77-f84d-5eaef9269745"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["False    41172\n","True     10311\n","Name: is_salient, dtype: int64"]},"metadata":{},"execution_count":17}],"source":["X_train[\"is_salient\"].value_counts()"]},{"cell_type":"markdown","metadata":{"id":"Gs_HU2MeiUco"},"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BXEwAgg1wyN_","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1699731026316,"user_tz":300,"elapsed":9914,"user":{"displayName":"Saadman Khan","userId":"18161026206221029184"}},"outputId":"c315386e-b39e-4298-a3c9-bc7217bf783c"},"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: tensorflow-text in /usr/local/lib/python3.10/dist-packages (2.14.0)\n","Requirement already satisfied: tensorflow-hub>=0.13.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow-text) (0.15.0)\n","Requirement already satisfied: tensorflow<2.15,>=2.14.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow-text) (2.14.0)\n","Requirement already satisfied: absl-py>=1.0.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (1.4.0)\n","Requirement already satisfied: astunparse>=1.6.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (1.6.3)\n","Requirement already satisfied: flatbuffers>=23.5.26 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (23.5.26)\n","Requirement already satisfied: gast!=0.5.0,!=0.5.1,!=0.5.2,>=0.2.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (0.4.0)\n","Requirement already satisfied: google-pasta>=0.1.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (0.2.0)\n","Requirement already satisfied: h5py>=2.9.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (3.9.0)\n","Requirement already satisfied: libclang>=13.0.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (16.0.6)\n","Requirement already satisfied: ml-dtypes==0.2.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (0.2.0)\n","Requirement already satisfied: numpy>=1.23.5 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (1.23.5)\n","Requirement already satisfied: opt-einsum>=2.3.2 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (3.3.0)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (23.2)\n","Requirement already satisfied: protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (3.20.3)\n","Requirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (67.7.2)\n","Requirement already satisfied: six>=1.12.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (1.16.0)\n","Requirement already satisfied: termcolor>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (2.3.0)\n","Requirement already satisfied: typing-extensions>=3.6.6 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (4.5.0)\n","Requirement already satisfied: wrapt<1.15,>=1.11.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (1.14.1)\n","Requirement already satisfied: tensorflow-io-gcs-filesystem>=0.23.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (0.34.0)\n","Requirement already satisfied: grpcio<2.0,>=1.24.3 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (1.59.2)\n","Requirement already satisfied: tensorboard<2.15,>=2.14 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (2.14.1)\n","Requirement already satisfied: tensorflow-estimator<2.15,>=2.14.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (2.14.0)\n","Requirement already satisfied: keras<2.15,>=2.14.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<2.15,>=2.14.0->tensorflow-text) (2.14.0)\n","Requirement already satisfied: wheel<1.0,>=0.23.0 in /usr/local/lib/python3.10/dist-packages (from astunparse>=1.6.0->tensorflow<2.15,>=2.14.0->tensorflow-text) (0.41.3)\n","Requirement already satisfied: google-auth<3,>=1.6.3 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (2.17.3)\n","Requirement already satisfied: google-auth-oauthlib<1.1,>=0.5 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (1.0.0)\n","Requirement already satisfied: markdown>=2.6.8 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (3.5.1)\n","Requirement already satisfied: requests<3,>=2.21.0 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (2.31.0)\n","Requirement already satisfied: tensorboard-data-server<0.8.0,>=0.7.0 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (0.7.2)\n","Requirement already satisfied: werkzeug>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (3.0.1)\n","Requirement already satisfied: cachetools<6.0,>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from google-auth<3,>=1.6.3->tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (5.3.2)\n","Requirement already satisfied: pyasn1-modules>=0.2.1 in /usr/local/lib/python3.10/dist-packages (from google-auth<3,>=1.6.3->tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (0.3.0)\n","Requirement already satisfied: rsa<5,>=3.1.4 in /usr/local/lib/python3.10/dist-packages (from google-auth<3,>=1.6.3->tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (4.9)\n","Requirement already satisfied: requests-oauthlib>=0.7.0 in /usr/local/lib/python3.10/dist-packages (from google-auth-oauthlib<1.1,>=0.5->tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (1.3.1)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (3.4)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (2023.7.22)\n","Requirement already satisfied: MarkupSafe>=2.1.1 in /usr/local/lib/python3.10/dist-packages (from werkzeug>=1.0.1->tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (2.1.3)\n","Requirement already satisfied: pyasn1<0.6.0,>=0.4.6 in /usr/local/lib/python3.10/dist-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (0.5.0)\n","Requirement already satisfied: oauthlib>=3.0.0 in /usr/local/lib/python3.10/dist-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<1.1,>=0.5->tensorboard<2.15,>=2.14->tensorflow<2.15,>=2.14.0->tensorflow-text) (3.2.2)\n"]}],"source":["pip install tensorflow-text"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Mrw34__mvo4F","colab":{"base_uri":"https://localhost:8080/","height":527},"executionInfo":{"status":"error","timestamp":1699733531851,"user_tz":300,"elapsed":133,"user":{"displayName":"Saadman Khan","userId":"18161026206221029184"}},"outputId":"cb5a3dab-a176-4b5e-a325-aa96ef0f199b"},"outputs":[{"output_type":"error","ename":"ImportError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mImportError\u001b[0m                               Traceback (most recent call last)","\u001b[0;32m<ipython-input-25-a46b4e2a0963>\u001b[0m in \u001b[0;36m<cell line: 3>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mtensorflow\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0mtf\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      2\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mtensorflow_hub\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0mhub\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 3\u001b[0;31m \u001b[0;32mimport\u001b[0m \u001b[0mtensorflow_text\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0mtext\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      4\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0mgoogle\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcolab\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mdrive\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0mtransformers\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mBertTokenizer\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mTFBertModel\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/tensorflow_text/__init__.py\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m     18\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     19\u001b[0m \u001b[0;31m# pylint: disable=wildcard-import\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 20\u001b[0;31m \u001b[0;32mfrom\u001b[0m \u001b[0mtensorflow_text\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcore\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpybinds\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mtflite_registrar\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     21\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0mtensorflow_text\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpython\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mkeras\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     22\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0mtensorflow_text\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpython\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mmetrics\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mImportError\u001b[0m: /usr/local/lib/python3.10/dist-packages/tensorflow_text/core/pybinds/tflite_registrar.so: undefined symbol: _ZN4absl12lts_2023012516raw_log_internal21internal_log_functionB5cxx11E","","\u001b[0;31m---------------------------------------------------------------------------\u001b[0;32m\nNOTE: If your import is failing due to a missing package, you can\nmanually install dependencies using either !pip or !apt.\n\nTo view examples of installing some common dependencies, click the\n\"Open Examples\" button below.\n\u001b[0;31m---------------------------------------------------------------------------\u001b[0m\n"],"errorDetails":{"actions":[{"action":"open_url","actionText":"Open Examples","url":"/notebooks/snippets/importing_libraries.ipynb"}]}}],"source":["import tensorflow as tf\n","import tensorflow_hub as hub\n","import tensorflow_text as text\n","from google.colab import drive\n","from transformers import BertTokenizer, TFBertModel\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":288,"referenced_widgets":["3013cd8850b848cba6b5693f1611b572","88b38d52a2ea49b280c32e971558cb40","c956356f268243858edaba5884af1853","e20e7b78d9d740aa9d5b2d0de0ad2aea","11319b6f9b12406494598e93f46b672f","f65da70ec2a0427eb5e4c6768b0f0026","4643f08476844ec3beca96cf1a084b4f","ed7335f550024a0488811b766ea8726f","f25aca113c454a6b874b8508a6cec164","a7db4b24eadb42808b5ee227403ed7c7","d76d10f2860f450da1a2d8f819fd9906","3162abe71aa84848af6761501a2ce4c7","c9b1ec9dc8bb431394bde2d39afcc7cb","f0fecf73d7644712a07929c38ecbe9e5","d076824be72349f8ad55f6cf4dcde84c","e25a689ce3624a3c86fbf10a937717cc","560f713b4a5d43a5925b1659cb31a486","5e25d15953084e0e817c4e2cacea19cd","99838cf65d564f6c8dd29bb547110697","30c2d4b1686849658eb0134f010b8648","e7017e4b317d4e4d86535052b7c0ffc7","4f1852fad35640ffa764a2ff033925d1","917781504507451abb520a6427c54d37","4b23d92ee64e486d8c65eaaa3b92354d","9ae0ce60ac70473ca4cb989984ae27ea","73384dd6893f417b87d8160134bfeada","309e98a8ad5c40d182776b41886bdf59","3125fd961353453e8b2ea404cb98aa4e","89a266a11d004c5c8f17a3c2ba0ef535","4384503923544080bc7b95e8090a519d","ce642b795bc94df982a82a184f517a2b","60f3294883c6485790d3a6cc6327d9d9","3f8db8c85c5449b0b2392d56c2ce97e3","b5695f25ffa3423683d2c70cba0cb142","2711e12d2ed04f68acd1bc4930b61c53","d617fcccf1314394aee72f69af87776f","a203cc6030e346298f20c2eb2e76f28a","fb7fb3cafbd5485f8aed6b6722664351","af68892a6d2e4290ac826c49be891c26","f33ba0ed28434479b12f6a3e942e74f3","da80481326a1478e9b2e16c39bdfbec1","0665fa473ae34fa4a3b6c89179f9370f","9cc62e83dda943dd8da840e128ae3413","cc55fcc992b84ba69832840f4cf0f458","db313761785d43e3a602164f3ef31f24","e69d02969c98482cb375d9580c223a75","069679084e6148bf852638efb0429a4f","ac013c2d7bcd43db92c6a64918e8798b","89337f0c17ed420f9562620d83befadc","42a9166268cf48e5b6ce1dd2e54a76ae","245a3316775f42a6a144b99726c6abe8","c0f256dc39ac4444bf9d5850d0c46365","52635b0afb8f4a238fdc996f6b6b23ae","92520ef49f874f18843cab49bebbbb07","72a0cbffecf749f5aa8078ec5f6d3729"]},"executionInfo":{"elapsed":31521,"status":"ok","timestamp":1699731067734,"user":{"displayName":"Saadman Khan","userId":"18161026206221029184"},"user_tz":300},"id":"gQcwPF4d4QzO","outputId":"5be63d0e-2d7b-4270-d824-71ed38e32e8c"},"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading (…)okenizer_config.json:   0%|          | 0.00/28.0 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"3013cd8850b848cba6b5693f1611b572"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)solve/main/vocab.txt:   0%|          | 0.00/232k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"3162abe71aa84848af6761501a2ce4c7"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)/main/tokenizer.json:   0%|          | 0.00/466k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"917781504507451abb520a6427c54d37"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)lve/main/config.json:   0%|          | 0.00/570 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b5695f25ffa3423683d2c70cba0cb142"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading model.safetensors:   0%|          | 0.00/440M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"db313761785d43e3a602164f3ef31f24"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some weights of the PyTorch model were not used when initializing the TF 2.0 model TFBertModel: ['cls.seq_relationship.weight', 'cls.predictions.transform.dense.weight', 'cls.predictions.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.seq_relationship.bias', 'cls.predictions.transform.dense.bias', 'cls.predictions.transform.LayerNorm.weight']\n","- This IS expected if you are initializing TFBertModel from a PyTorch model trained on another task or with another architecture (e.g. initializing a TFBertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing TFBertModel from a PyTorch model that you expect to be exactly identical (e.g. initializing a TFBertForSequenceClassification model from a BertForSequenceClassification model).\n","All the weights of TFBertModel were initialized from the PyTorch model.\n","If your task is similar to the task the model of the checkpoint was trained on, you can already use TFBertModel for predictions without further training.\n"]}],"source":["#Tokenizing Words in sentneces and also apply encoding model\n","from transformers import BertTokenizer, TFBertModel\n","tokenizer = BertTokenizer.from_pretrained('bert-base-uncased')\n","model = TFBertModel.from_pretrained(\"bert-base-uncased\")\n","text = \"Replace me by any text you'd like.\"\n","encoded_input = tokenizer(text, return_tensors='tf')\n","output = model(encoded_input)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1002,"status":"ok","timestamp":1698815157347,"user":{"displayName":"Saadman Khan","userId":"18161026206221029184"},"user_tz":240},"id":"t8YA0FN53Gvu","outputId":"15fbf12d-4efc-4b79-f774-fe36615f5eba"},"outputs":[{"name":"stdout","output_type":"stream","text":["TFBaseModelOutputWithPoolingAndCrossAttentions(last_hidden_state=<tf.Tensor: shape=(1, 12, 768), dtype=float32, numpy=\n","array([[[ 0.1386273 ,  0.15826872, -0.29666477, ..., -0.27084953,\n","         -0.2843629 ,  0.45808473],\n","        [ 0.5363635 , -0.23269637,  0.17541927, ...,  0.55402505,\n","          0.49807125, -0.00240827],\n","        [ 0.300238  , -0.34751162,  0.12084398, ..., -0.4562487 ,\n","          0.3288021 ,  0.8772818 ],\n","        ...,\n","        [ 0.3798591 ,  0.12028816,  0.82829344, ..., -0.8623719 ,\n","         -0.59569687,  0.0471146 ],\n","        [-0.02524215, -0.71767503, -0.6950478 , ...,  0.07574263,\n","         -0.6667813 , -0.34007427],\n","        [ 0.7535381 ,  0.2391096 ,  0.07174394, ...,  0.24671488,\n","         -0.64580667, -0.32129782]]], dtype=float32)>, pooler_output=<tf.Tensor: shape=(1, 768), dtype=float32, numpy=\n","array([[-0.93767864, -0.5042589 , -0.9798931 ,  0.9030441 ,  0.93293256,\n","        -0.2437751 ,  0.8925754 ,  0.22880596, -0.9531208 , -0.99999535,\n","        -0.88623023,  0.99055725,  0.9855202 ,  0.71552855,  0.94547635,\n","        -0.8644849 , -0.6035239 , -0.6665585 ,  0.30200142, -0.15873331,\n","         0.745527  ,  1.        , -0.40218872,  0.42608023,  0.61509025,\n","         0.999623  , -0.87733626,  0.95938957,  0.9585287 ,  0.695015  ,\n","        -0.6718386 ,  0.33250877, -0.9953591 , -0.2267552 , -0.9657978 ,\n","        -0.9951097 ,  0.6127019 , -0.7669506 ,  0.08734445,  0.082364  ,\n","        -0.9518443 ,  0.47129765,  0.99999803,  0.32989472,  0.7583103 ,\n","        -0.2670484 , -1.        ,  0.31664473, -0.9364274 ,  0.99103236,\n","         0.9719467 ,  0.9892896 ,  0.21901847,  0.60477   ,  0.5848997 ,\n","        -0.41227174, -0.00629393,  0.17190638, -0.39875728, -0.61899304,\n","        -0.6603152 ,  0.50686777, -0.9756918 , -0.903931  ,  0.99262434,\n","         0.9322654 , -0.36873198, -0.48690683, -0.31432307,  0.04989551,\n","         0.9129025 ,  0.3396146 , -0.18794702, -0.9234626 ,  0.86747617,\n","         0.32275367, -0.640608  ,  1.        , -0.79885286, -0.99306864,\n","         0.9629331 ,  0.9124064 ,  0.48271623, -0.72755826,  0.5996145 ,\n","        -1.        ,  0.7548478 , -0.15996994, -0.994149  ,  0.3385823 ,\n","         0.8394348 , -0.41577396,  0.29430982,  0.6110962 , -0.574477  ,\n","        -0.71845084, -0.4768405 , -0.9681442 , -0.43267035, -0.6732334 ,\n","         0.12483037, -0.20933406, -0.5881844 , -0.41860688,  0.5447092 ,\n","        -0.6125472 , -0.61380684,  0.4712144 ,  0.4779143 ,  0.763329  ,\n","         0.39740157, -0.41479248,  0.7063263 , -0.968018  ,  0.7389451 ,\n","        -0.4269572 , -0.9947576 , -0.60186756, -0.99504566,  0.7459067 ,\n","        -0.6342811 , -0.27531832,  0.9522239 , -0.57242715,  0.62179524,\n","        -0.12949024, -0.9905181 , -1.        , -0.8709735 , -0.75060683,\n","        -0.50083554, -0.48268545, -0.9871631 , -0.9847019 ,  0.721362  ,\n","         0.9694464 ,  0.30128106,  0.99999076, -0.44266844,  0.9698507 ,\n","        -0.5431187 , -0.8188721 ,  0.91802967, -0.51319575,  0.9025567 ,\n","         0.5273865 , -0.5939678 ,  0.2927997 , -0.6932561 ,  0.7179122 ,\n","        -0.93183655, -0.2775918 , -0.9160482 , -0.9456746 , -0.3286886 ,\n","         0.95555574, -0.79270756, -0.98600274, -0.19044155, -0.27600527,\n","        -0.6061538 ,  0.9005307 ,  0.92663735,  0.43529785, -0.6858308 ,\n","         0.47204015,  0.2850683 ,  0.7684513 , -0.86466587, -0.5625775 ,\n","         0.5126705 , -0.54683435, -0.9490087 , -0.9907118 , -0.58090615,\n","         0.7146272 ,  0.9948339 ,  0.7980903 ,  0.3462593 ,  0.9348572 ,\n","        -0.42384458,  0.9332701 , -0.97544646,  0.99358255, -0.2596514 ,\n","         0.46646726, -0.5399993 ,  0.49472576, -0.8722778 ,  0.00338855,\n","         0.83776444, -0.913425  , -0.8431693 , -0.25158215, -0.51769036,\n","        -0.46870983, -0.94909763,  0.5691279 , -0.4855811 , -0.4856517 ,\n","        -0.22445983,  0.9609392 ,  0.98228943,  0.7495633 ,  0.62555134,\n","         0.85518974, -0.9073244 , -0.5802432 ,  0.28742278,  0.30171227,\n","         0.30159456,  0.99737537, -0.85030496, -0.21080595, -0.9260726 ,\n","        -0.990708  , -0.02516768, -0.94884783, -0.3971862 , -0.80972636,\n","         0.87068224, -0.75122833,  0.8106708 ,  0.5487629 , -0.98298633,\n","        -0.85692143,  0.48523533, -0.615557  ,  0.48461318, -0.28931567,\n","         0.9647097 ,  0.985797  , -0.7064293 ,  0.7120397 ,  0.95934504,\n","        -0.9589811 , -0.8707508 ,  0.78927696, -0.35606402,  0.8602997 ,\n","        -0.72429246,  0.98818666,  0.98757863,  0.9282262 , -0.9547475 ,\n","        -0.8328893 , -0.79934967, -0.8397693 , -0.23329654,  0.23149182,\n","         0.97116846,  0.60545266,  0.63881934,  0.24286766, -0.78839785,\n","         0.99813026, -0.94476086, -0.9803667 , -0.8184383 , -0.35336712,\n","        -0.99509096,  0.9728791 ,  0.4164664 ,  0.80936915, -0.6227092 ,\n","        -0.8183278 , -0.981674  ,  0.8531911 ,  0.12420879,  0.98260236,\n","        -0.63760746, -0.9450061 , -0.8093606 , -0.9747824 ,  0.04117998,\n","        -0.3097101 , -0.81533074, -0.03058969, -0.9255173 ,  0.56768566,\n","         0.6216603 ,  0.6651731 , -0.968216  ,  0.99972993,  1.        ,\n","         0.9825574 ,  0.9013465 ,  0.8950183 , -0.9999986 , -0.8081251 ,\n","         0.9999988 , -0.9995222 , -1.        , -0.9361453 , -0.82000816,\n","         0.47551462, -1.        , -0.269762  , -0.01114202, -0.92966133,\n","         0.8491546 ,  0.9879218 ,  0.9950281 , -1.        ,  0.86529595,\n","         0.9512622 , -0.5678964 ,  0.99655616, -0.6713039 ,  0.9814816 ,\n","         0.60079926,  0.7414178 , -0.3265391 ,  0.55741006, -0.9800917 ,\n","        -0.89560366, -0.80820984, -0.92667603,  0.99993634,  0.25422564,\n","        -0.79697573, -0.88540417,  0.78310853, -0.13913655, -0.0060418 ,\n","        -0.9786411 , -0.45033988,  0.88950574,  0.90208983,  0.30214235,\n","         0.2650315 , -0.575034  ,  0.50986266,  0.12155073,  0.11702016,\n","         0.64840996, -0.9504878 , -0.38886136, -0.6937502 ,  0.25076625,\n","        -0.75262505, -0.98310596,  0.9646208 , -0.2742128 ,  0.9864836 ,\n","         1.        ,  0.37562203, -0.9045103 ,  0.88469756,  0.48601148,\n","        -0.551464  ,  1.        ,  0.9092157 , -0.9904048 , -0.49585927,\n","         0.79001325, -0.71559954, -0.82802504,  0.99985796, -0.41974092,\n","        -0.9281557 , -0.77326983,  0.99445647, -0.99556184,  0.9997706 ,\n","        -0.89851373, -0.98384994,  0.97349924,  0.96547365, -0.8102997 ,\n","        -0.8325333 ,  0.10202604, -0.6722141 ,  0.4561355 , -0.9412215 ,\n","         0.8395839 ,  0.6978767 , -0.12014566,  0.92877567, -0.834504  ,\n","        -0.6312199 ,  0.43557164, -0.8900794 , -0.4564861 ,  0.98736167,\n","         0.5708537 , -0.21105173, -0.02060659, -0.41823646, -0.91158456,\n","        -0.97806305,  0.8245927 ,  1.        , -0.42286915,  0.94891286,\n","        -0.52259135, -0.09856717,  0.22024477,  0.7459151 ,  0.7152117 ,\n","        -0.35277772, -0.87997043,  0.9298511 , -0.9716049 , -0.99490005,\n","         0.7277596 ,  0.22061624, -0.49437502,  1.        ,  0.6284998 ,\n","         0.3794799 ,  0.7227853 ,  0.99931616,  0.03006995,  0.59361887,\n","         0.981552  ,  0.9914457 , -0.34654397,  0.5882205 ,  0.83653957,\n","        -0.9824206 , -0.4488425 , -0.76117074,  0.13310784, -0.94793   ,\n","        -0.05588032, -0.96974975,  0.98457897,  0.9960217 ,  0.5818411 ,\n","         0.3121037 ,  0.8577062 ,  1.        , -0.92739034,  0.66934896,\n","        -0.13647233,  0.80350417, -0.9999917 , -0.80565125, -0.45044866,\n","        -0.17113791, -0.9512214 , -0.5898851 ,  0.39912355, -0.97544944,\n","         0.9563166 ,  0.88056123, -0.9937362 , -0.9922803 , -0.49792996,\n","         0.8853259 ,  0.14390926, -0.9993915 , -0.8985792 , -0.6272291 ,\n","         0.8385114 , -0.32385346, -0.947019  , -0.70087904, -0.47676125,\n","         0.5741789 , -0.2215695 ,  0.56645584,  0.9666835 ,  0.7934849 ,\n","        -0.9401055 , -0.67459375, -0.17533833, -0.9163418 ,  0.940934  ,\n","        -0.8701089 , -0.98936045, -0.2514083 ,  1.        , -0.40869674,\n","         0.9385276 ,  0.60501194,  0.8218855 , -0.27122396,  0.3326212 ,\n","         0.9827238 ,  0.36131942, -0.83142096, -0.9849706 , -0.28606445,\n","        -0.53982097,  0.8254337 ,  0.8414237 ,  0.75901294,  0.9412288 ,\n","         0.9627104 ,  0.27651012, -0.07372515,  0.03992787,  0.9998473 ,\n","        -0.30951777, -0.19327559, -0.46890193, -0.25110948, -0.4629131 ,\n","        -0.29137442,  1.        ,  0.39625418,  0.7777107 , -0.9949603 ,\n","        -0.98075765, -0.930253  ,  1.        ,  0.8822245 , -0.68483055,\n","         0.8123738 ,  0.62417614, -0.25508195,  0.8266011 , -0.27906558,\n","        -0.31672716,  0.22944528,  0.16818143,  0.9627001 , -0.6737688 ,\n","        -0.99035704, -0.7910482 ,  0.7099378 , -0.9769668 ,  0.9999993 ,\n","        -0.7029679 , -0.39604872, -0.5981425 , -0.6682931 , -0.27273408,\n","        -0.0182958 , -0.9881756 , -0.3841482 ,  0.56053275,  0.9744537 ,\n","         0.35048938, -0.48977128, -0.929834  ,  0.95783514,  0.953261  ,\n","        -0.9858871 , -0.95974535,  0.9777034 , -0.978429  ,  0.7550498 ,\n","         1.        ,  0.34458756,  0.6786017 ,  0.39467093, -0.5348905 ,\n","         0.55405414, -0.67538315,  0.80778855, -0.9594636 , -0.44842383,\n","        -0.39005488,  0.39831248, -0.13191767, -0.28959322,  0.78603184,\n","         0.3499926 , -0.5530307 , -0.7294457 , -0.23607804,  0.4663448 ,\n","         0.93319285, -0.30481076, -0.19163476,  0.23183013, -0.32304835,\n","        -0.93234104, -0.4672352 , -0.63153917, -1.        ,  0.80679494,\n","        -1.        ,  0.80352634,  0.40656883, -0.36996433,  0.8760367 ,\n","         0.7829032 ,  0.82984275, -0.8628251 , -0.9794617 ,  0.13217954,\n","         0.8529288 , -0.5028955 , -0.90573984, -0.6917758 ,  0.50166094,\n","        -0.20521946,  0.15640728, -0.7397343 ,  0.815563  , -0.34136406,\n","         1.        ,  0.2658982 , -0.8292072 , -0.982118  ,  0.24909689,\n","        -0.30092293,  1.        , -0.89523524, -0.98315346,  0.33299085,\n","        -0.9179501 , -0.849329  ,  0.5867561 ,  0.16526476, -0.8522475 ,\n","        -0.9960892 ,  0.92204565,  0.86608034, -0.64769673,  0.792742  ,\n","        -0.39908418, -0.7690825 ,  0.15115355,  0.9868105 ,  0.99243414,\n","         0.73167455,  0.9082755 , -0.1226495 , -0.5258375 ,  0.9840352 ,\n","         0.4008645 , -0.04361108,  0.1360867 ,  1.        ,  0.40037203,\n","        -0.94971853, -0.13093887, -0.9787602 , -0.35216966, -0.9551131 ,\n","         0.37547478,  0.30993965,  0.919471  , -0.44600484,  0.9738112 ,\n","        -0.9713666 ,  0.19009374, -0.8894485 , -0.7863345 ,  0.47566864,\n","        -0.94628006, -0.98922896, -0.99379843,  0.8141797 , -0.40769172,\n","        -0.18950014,  0.21021213,  0.1715005 ,  0.63221526,  0.55656344,\n","        -1.        ,  0.9642159 ,  0.61497796,  0.9767502 ,  0.97680116,\n","         0.9114744 ,  0.8108152 ,  0.32505694, -0.9919877 , -0.99103516,\n","        -0.54379755, -0.3567472 ,  0.79595315,  0.7647876 ,  0.8900012 ,\n","         0.6469602 , -0.48747814, -0.47918585, -0.7755679 , -0.8422665 ,\n","        -0.9971619 ,  0.5961326 , -0.8679444 , -0.967766  ,  0.9718348 ,\n","        -0.3461102 , -0.15342864, -0.21388389, -0.9586422 ,  0.93210816,\n","         0.7627045 ,  0.4636386 ,  0.08617752,  0.50709873,  0.9170013 ,\n","         0.9596649 ,  0.98817444, -0.92305714,  0.8554585 , -0.91963255,\n","         0.67122084,  0.93809915, -0.9606302 ,  0.23346208,  0.8300923 ,\n","        -0.556011  ,  0.3696073 , -0.47518626, -0.9740051 ,  0.8173753 ,\n","        -0.426775  ,  0.7772788 , -0.4797865 ,  0.06386221, -0.4718475 ,\n","        -0.2606735 , -0.76236784, -0.87422585,  0.6576241 ,  0.6207222 ,\n","         0.9219021 ,  0.93597674, -0.04963608, -0.89422816, -0.37006146,\n","        -0.89439756, -0.9525817 ,  0.9536075 , -0.08509365, -0.29609826,\n","         0.9030917 ,  0.13211595,  0.9323626 ,  0.42885354, -0.4989079 ,\n","        -0.4174366 , -0.7638585 ,  0.888679  , -0.7894223 , -0.7638758 ,\n","        -0.7092896 ,  0.81046236,  0.3595106 ,  1.        , -0.9188115 ,\n","        -0.98778635, -0.82680064, -0.6011909 ,  0.49917868, -0.7880205 ,\n","        -1.        ,  0.36094284, -0.8313559 ,  0.8524062 , -0.9397852 ,\n","         0.94995785, -0.9338528 , -0.9851252 , -0.34948182,  0.843627  ,\n","         0.9374619 , -0.515869  , -0.8989186 ,  0.51955813, -0.87971103,\n","         0.9979246 ,  0.87525606, -0.82766604, -0.00118578,  0.6012696 ,\n","        -0.9184479 , -0.73978657,  0.9227984 ]], dtype=float32)>, past_key_values=None, hidden_states=None, attentions=None, cross_attentions=None)\n"]}],"source":["trial=\"I am Rami\"\n","encoded_input=tokenizer(text,return_tensors=\"tf\")\n","output=model(encoded_input)\n","print(output)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"u_e68wKi6Bdf"},"outputs":[],"source":["BERT_Encodings=[]\n","for sentence in X_train[\"sentence\"]:\n","  encoded_input=tokenizer(sentence,return_tensors=\"tf\")\n","  output=model(encoded_input)\n","  BERT_Encodings.append(output)\n","BERT_Encoding_pd=pd.DataFrame()\n","BERT_Encoding_pd[\"Encoding\"]=BERT_Encodings\n","fileName=\"BERT_Enconding.xlsx\"\n","BERT_Encoding_pd.to_excel(fileName)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"yQcFQI2i3YOB"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YXuGxRijx3WR","colab":{"base_uri":"https://localhost:8080/","height":624},"executionInfo":{"status":"error","timestamp":1699733552090,"user_tz":300,"elapsed":297,"user":{"displayName":"Saadman Khan","userId":"18161026206221029184"}},"outputId":"5858b269-e6f4-498e-c352-cd2c728899e5"},"outputs":[{"output_type":"error","ename":"FileNotFoundError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyError\u001b[0m                                  Traceback (most recent call last)","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/tensorflow/python/framework/ops.py\u001b[0m in \u001b[0;36m_get_op_def\u001b[0;34m(self, type)\u001b[0m\n\u001b[1;32m   4214\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 4215\u001b[0;31m   \u001b[0;34m@\u001b[0m\u001b[0mproperty\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   4216\u001b[0m   \u001b[0;32mdef\u001b[0m \u001b[0m_colocation_stack\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mKeyError\u001b[0m: 'CaseFoldUTF8'","\nDuring handling of the above exception, another exception occurred:\n","\u001b[0;31mNotFoundError\u001b[0m                             Traceback (most recent call last)","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/tensorflow/python/saved_model/load.py\u001b[0m in \u001b[0;36mload_partial\u001b[0;34m(export_dir, filters, tags, options)\u001b[0m\n\u001b[1;32m    965\u001b[0m   \u001b[0;31m# Load with no strategy\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 966\u001b[0;31m   loaded = tf.__internal__.saved_model.load_partial(\n\u001b[0m\u001b[1;32m    967\u001b[0m   \u001b[0;34m...\u001b[0m   \u001b[0;34m'/tmp/model'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/tensorflow/python/saved_model/load.py\u001b[0m in \u001b[0;36m__init__\u001b[0;34m(self, object_graph_proto, saved_model_proto, export_dir, ckpt_options, save_options, filters)\u001b[0m\n\u001b[1;32m    156\u001b[0m     self._operation_attributes = {\n\u001b[0;32m--> 157\u001b[0;31m         node.name: node.attr for node in meta_graph.graph_def.node}\n\u001b[0m\u001b[1;32m    158\u001b[0m     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_proto\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mobject_graph_proto\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/tensorflow/python/saved_model/function_deserialization.py\u001b[0m in \u001b[0;36mload_function_def_library\u001b[0;34m(library, saved_object_graph, load_shared_name_suffix, wrapper_function)\u001b[0m\n\u001b[1;32m    415\u001b[0m       \u001b[0mlibrary_gradient_names\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mold_op_type\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mgdef\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mgradient_func\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 416\u001b[0;31m       \u001b[0mnew_gradient_op_types\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mold_op_type\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnew_op_type\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    417\u001b[0m       \u001b[0mgradients_to_register\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mgdef\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mgradient_func\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnew_op_type\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/tensorflow/python/framework/function_def_to_graph.py\u001b[0m in \u001b[0;36mfunction_def_to_graph\u001b[0;34m(fdef, structured_input_signature, structured_outputs, input_shapes, propagate_device_spec)\u001b[0m\n\u001b[1;32m     84\u001b[0m       for input_shape, arg_def in zip(raw_input_shapes,\n\u001b[0;32m---> 85\u001b[0;31m                                       fdef.signature.input_arg):\n\u001b[0m\u001b[1;32m     86\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0marg_def\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtype\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0mtypes_pb2\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mDT_RESOURCE\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0marg_def\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mhandle_data\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/tensorflow/python/framework/function_def_to_graph.py\u001b[0m in \u001b[0;36mfunction_def_to_graph_def\u001b[0;34m(fdef, input_shapes)\u001b[0m\n\u001b[1;32m    255\u001b[0m       versions_pb2.VersionDef(\n\u001b[0;32m--> 256\u001b[0;31m           \u001b[0mproducer\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mversions\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mGRAPH_DEF_VERSION\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    257\u001b[0m           min_consumer=versions.GRAPH_DEF_VERSION_MIN_CONSUMER))\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/tensorflow/python/framework/ops.py\u001b[0m in \u001b[0;36m_get_op_def\u001b[0;34m(self, type)\u001b[0m\n\u001b[1;32m   4218\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_stack_state_is_thread_local\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 4219\u001b[0;31m       \u001b[0;31m# This may be called from a thread where colocation_stack doesn't yet\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   4220\u001b[0m       \u001b[0;31m# exist.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mNotFoundError\u001b[0m: Op type not registered 'CaseFoldUTF8' in binary running on d6314bc3e5af. Make sure the Op and Kernel are registered in the binary running in this process. Note that if you are loading a saved graph which used ops from tf.contrib, accessing (e.g.) `tf.contrib.resampler` should be done before importing the graph, as contrib ops are lazily registered when the module is first accessed.","\nDuring handling of the above exception, another exception occurred:\n","\u001b[0;31mFileNotFoundError\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m<ipython-input-26-4231c2a9f7e5>\u001b[0m in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mbert_preprocess\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mhub\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mKerasLayer\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"https://tfhub.dev/tensorflow/bert_en_uncased_preprocess/3\"\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;31m#Applies tokenization, formats for a Keras NN https://keras.io/api/keras_nlp/models/bert/bert_preprocessor/#:~:text=A%20BERT%20preprocessing%20layer%20which,inputs%20together%20using%20a%20keras_nlp.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      2\u001b[0m \u001b[0mbert_encoder\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mhub\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mKerasLayer\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"https://tfhub.dev/tensorflow/bert_en_uncased_L-12_H-768_A-12/4\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtrainable\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/tensorflow_hub/keras_layer.py\u001b[0m in \u001b[0;36m__init__\u001b[0;34m(self, handle, trainable, arguments, _sentinel, tags, signature, signature_outputs_as_dict, output_key, output_shape, load_options, **kwargs)\u001b[0m\n\u001b[1;32m    155\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    156\u001b[0m     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_load_options\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mload_options\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 157\u001b[0;31m     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_func\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mload_module\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mhandle\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtags\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_load_options\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    158\u001b[0m     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_is_hub_module_v1\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mgetattr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_func\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m\"_is_hub_module_v1\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    159\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/tensorflow_hub/keras_layer.py\u001b[0m in \u001b[0;36mload_module\u001b[0;34m(handle, tags, load_options)\u001b[0m\n\u001b[1;32m    457\u001b[0m         \u001b[0;32mexcept\u001b[0m \u001b[0mImportError\u001b[0m\u001b[0;34m:\u001b[0m  \u001b[0;31m# Expected before TF2.4.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    458\u001b[0m           \u001b[0mset_load_options\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mload_options\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 459\u001b[0;31m     \u001b[0;32mreturn\u001b[0m \u001b[0mmodule_v2\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mload\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mhandle\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtags\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mtags\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0moptions\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mset_load_options\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    460\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    461\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/tensorflow_hub/module_v2.py\u001b[0m in \u001b[0;36mload\u001b[0;34m(handle, tags, options)\u001b[0m\n\u001b[1;32m    118\u001b[0m         module_path, tags=tags, options=options)\n\u001b[1;32m    119\u001b[0m   \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 120\u001b[0;31m     \u001b[0mobj\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcompat\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mv1\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msaved_model\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mload_v2\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodule_path\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtags\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mtags\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    121\u001b[0m   \u001b[0mobj\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_is_hub_module_v1\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mis_hub_module_v1\u001b[0m  \u001b[0;31m# pylint: disable=protected-access\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    122\u001b[0m   \u001b[0;32mreturn\u001b[0m \u001b[0mobj\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/tensorflow/python/saved_model/load.py\u001b[0m in \u001b[0;36mload\u001b[0;34m(export_dir, tags, options)\u001b[0m\n\u001b[1;32m    834\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    835\u001b[0m   \u001b[0mKeras\u001b[0m \u001b[0mmodels\u001b[0m \u001b[0mare\u001b[0m \u001b[0mtrackable\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mso\u001b[0m \u001b[0mthey\u001b[0m \u001b[0mcan\u001b[0m \u001b[0mbe\u001b[0m \u001b[0msaved\u001b[0m \u001b[0mto\u001b[0m \u001b[0mSavedModel\u001b[0m\u001b[0;34m.\u001b[0m \u001b[0mThe\u001b[0m \u001b[0mobject\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 836\u001b[0;31m   returned by `tf.saved_model.load` is not a Keras object (i.e. doesn't have\n\u001b[0m\u001b[1;32m    837\u001b[0m   `.fit`, `.predict`, etc. methods). A few attributes and functions are still\n\u001b[1;32m    838\u001b[0m   \u001b[0mavailable\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;31m \u001b[0m\u001b[0;31m`\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mvariables\u001b[0m\u001b[0;31m`\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;31m \u001b[0m\u001b[0;31m`\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtrainable_variables\u001b[0m\u001b[0;31m`\u001b[0m \u001b[0;32mand\u001b[0m\u001b[0;31m \u001b[0m\u001b[0;31m`\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__call__\u001b[0m\u001b[0;31m`\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/tensorflow/python/saved_model/load.py\u001b[0m in \u001b[0;36mload_partial\u001b[0;34m(export_dir, filters, tags, options)\u001b[0m\n\u001b[1;32m    967\u001b[0m   \u001b[0;34m...\u001b[0m   \u001b[0;34m'/tmp/model'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    968\u001b[0m   ...   ['root.layer_1'])\n\u001b[0;32m--> 969\u001b[0;31m   \u001b[0mloaded\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'root.layer_1'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mv\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    970\u001b[0m   \u001b[0;34m<\u001b[0m\u001b[0mtf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mVariable\u001b[0m \u001b[0;34m'Variable:0'\u001b[0m \u001b[0mshape\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0mdtype\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mfloat32\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mnumpy\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m5.0\u001b[0m\u001b[0;34m>\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    971\u001b[0m   \u001b[0mstrategy\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdistribute\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mMirroredStrategy\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mFileNotFoundError\u001b[0m: Op type not registered 'CaseFoldUTF8' in binary running on d6314bc3e5af. Make sure the Op and Kernel are registered in the binary running in this process. Note that if you are loading a saved graph which used ops from tf.contrib, accessing (e.g.) `tf.contrib.resampler` should be done before importing the graph, as contrib ops are lazily registered when the module is first accessed.\n You may be trying to load on a different device from the computational device. Consider setting the `experimental_io_device` option in `tf.saved_model.LoadOptions` to the io_device such as '/job:localhost'."]}],"source":["bert_preprocess = hub.KerasLayer(\"https://tfhub.dev/tensorflow/bert_en_uncased_preprocess/3\") #Applies tokenization, formats for a Keras NN https://keras.io/api/keras_nlp/models/bert/bert_preprocessor/#:~:text=A%20BERT%20preprocessing%20layer%20which,inputs%20together%20using%20a%20keras_nlp.\n","bert_encoder = hub.KerasLayer(\"https://tfhub.dev/tensorflow/bert_en_uncased_L-12_H-768_A-12/4\", trainable=True)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CoPRtC7KFIdY"},"outputs":[],"source":["print(BERT_Encodings)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"fmZd93_qyBoc"},"outputs":[],"source":["def get_sentence_embeding(sentences):\n","    preprocessed_text = bert_preprocess(sentences)\n","    return bert_encoder(preprocessed_text)['pooled_output']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":217},"executionInfo":{"elapsed":9,"status":"error","timestamp":1698687570251,"user":{"displayName":"Saadman Khan","userId":"18161026206221029184"},"user_tz":240},"id":"kCJFETgdCfWp","outputId":"46fd23ef-8e38-4ff7-dea5-604e6e7bd590"},"outputs":[{"ename":"NameError","evalue":"ignored","output_type":"error","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-1-ee52b6285abb>\u001b[0m in \u001b[0;36m<cell line: 3>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0mBERT_Embeddings\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      2\u001b[0m \u001b[0msentence\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"I am Rami\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 3\u001b[0;31m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mget_sentence_embeding\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m26\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;31mNameError\u001b[0m: name 'get_sentence_embeding' is not defined"]}],"source":["BERT_Embeddings=[]\n","sentence=[\"I am Rami\"]\n","print(get_sentence_embeding(26))\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jumm-bJ7z3UD"},"outputs":[],"source":["#The difference between sequential and functional neural networks is that with a sequential you just have a skeleton onto which you attach neurons one by one\n","#With functional nueral networks you have to specify which neuron you connecting to which"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"idn53FQ91dDX"},"outputs":[],"source":["# Bert layers\n","text_input = tf.keras.layers.Input(shape=(), dtype=tf.string, name='text')\n","preprocessed_text = bert_preprocess(text_input)\n","outputs = bert_encoder(preprocessed_text)\n","\n","# Neural network layers\n","l = tf.keras.layers.Dropout(0.1, name=\"dropout\")(outputs['pooled_output'])\n","#This is to ensure overfitting does not occur with specific neurons heavily influencing the final result. The other neurons are forced to fill in the gap in training\n","#Link -https://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/\n","l = tf.keras.layers.Dense(1, activation='sigmoid', name=\"output\")(l)\n","#This layer tries to combine all previous neurons into one weighted matrix. Parameters like activation, User-Bias help reach a more reasoonable final answer\n","#Can be optimized with back propagation\n","\n","# Use inputs and outputs to construct a final model\n","NN_model = tf.keras.Model(inputs=[text_input], outputs = [l])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":184,"status":"ok","timestamp":1699318629307,"user":{"displayName":"Saadman Khan","userId":"18161026206221029184"},"user_tz":300},"id":"HvgYbHp_5CYb","outputId":"f4bf58d8-aa03-4743-e319-a7f796debf3a"},"outputs":[{"output_type":"stream","name":"stdout","text":["Model: \"model\"\n","__________________________________________________________________________________________________\n"," Layer (type)                Output Shape                 Param #   Connected to                  \n","==================================================================================================\n"," text (InputLayer)           [(None,)]                    0         []                            \n","                                                                                                  \n"," keras_layer (KerasLayer)    {'input_mask': (None, 128)   0         ['text[0][0]']                \n","                             , 'input_word_ids': (None,                                           \n","                              128),                                                               \n","                              'input_type_ids': (None,                                            \n","                             128)}                                                                \n","                                                                                                  \n"," keras_layer_1 (KerasLayer)  {'default': (None, 768),     1094822   ['keras_layer[0][0]',         \n","                              'encoder_outputs': [(None   41         'keras_layer[0][1]',         \n","                             , 128, 768),                            'keras_layer[0][2]']         \n","                              (None, 128, 768),                                                   \n","                              (None, 128, 768),                                                   \n","                              (None, 128, 768),                                                   \n","                              (None, 128, 768),                                                   \n","                              (None, 128, 768),                                                   \n","                              (None, 128, 768),                                                   \n","                              (None, 128, 768),                                                   \n","                              (None, 128, 768),                                                   \n","                              (None, 128, 768),                                                   \n","                              (None, 128, 768),                                                   \n","                              (None, 128, 768)],                                                  \n","                              'sequence_output': (None,                                           \n","                              128, 768),                                                          \n","                              'pooled_output': (None, 7                                           \n","                             68)}                                                                 \n","                                                                                                  \n"," dropout (Dropout)           (None, 768)                  0         ['keras_layer_1[0][13]']      \n","                                                                                                  \n"," output (Dense)              (None, 1)                    769       ['dropout[0][0]']             \n","                                                                                                  \n","==================================================================================================\n","Total params: 109483010 (417.64 MB)\n","Trainable params: 109483009 (417.64 MB)\n","Non-trainable params: 1 (1.00 Byte)\n","__________________________________________________________________________________________________\n"]}],"source":["NN_model.summary()\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"w1R8FGLuH2Ch"},"outputs":[],"source":["def clean(test,train,val):\n","  # Col for Word Count\n","  train['word_count']=train['sentence'].apply(lambda x:len(x.split()))\n","  test['word_count']=test['sentence'].apply(lambda x:len(x.split()))\n","  val['word_count']=val['sentence'].apply(lambda x:len(x.split()))\n","\n","  #adding a new column to X_train \"is_question\" that flags true for question senteces and false for non-question sentences\n","  question_words = [\"who\", \"what\", \"when\", \"where\", \"why\", \"how\", \"if\"]\n","  train['is_question'] = (train['sentence'].str.endswith('?') | train['sentence'].str.lower().str.contains(fr'\\b(?:{\"|\".join(question_words)})\\b'))\n","  test['is_question'] = (train['sentence'].str.endswith('?') | train['sentence'].str.lower().str.contains(fr'\\b(?:{\"|\".join(question_words)})\\b'))\n","  val['is_question'] = (train['sentence'].str.endswith('?') | train['sentence'].str.lower().str.contains(fr'\\b(?:{\"|\".join(question_words)})\\b'))\n","\n","  # # Drop sender, annot_id, dialog_id, and Unnamed: 0\n","  # train.drop(['sender', 'annot_id', 'dialog_id', 'Unnamed: 0'], axis = 1, inplace = True)\n","  # test.drop(['sender', 'annot_id', 'dialog_id', 'Unnamed: 0'], axis = 1, inplace = True)\n","  # val.drop(['sender', 'annot_id', 'dialog_id', 'Unnamed: 0'], axis = 1, inplace = True)\n","\n","  return test,train,val"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jlwqea7O5Lbr"},"outputs":[],"source":["NN_model.compile(optimizer='adam',\n","              loss='binary_crossentropy',\n","              metrics=['accuracy'])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PbHuyd_zID4Q"},"outputs":[],"source":["train, test, val = clean(X_train, X_test, X_val)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iYsoUXel5WGn"},"outputs":[],"source":["train = pd.get_dummies(train, columns = ['annot_id', 'sender'])\n","test = pd.get_dummies(test, columns = ['annot_id', 'sender'])\n","val =pd.get_dummies(val, columns = ['annot_id', 'sender'])\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ABuSknR3IXfU"},"outputs":[],"source":["val.columns\n","features=[ 'sentence', 'word_count',\n","       'is_question', 'annot_id_0', 'annot_id_1', 'annot_id_2', 'annot_id_3',\n","       'annot_id_4', 'sender_agent', 'sender_customer']\n","eval='is_salient'"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wD8GzWcCIgit"},"outputs":[],"source":["train['is_salient']=train['is_salient'].apply(lambda x: 1 if x==True else 0)\n","val['is_salient']=val['is_salient'].apply(lambda x: 1 if x==True else 0)\n","test['is_salient']=test['is_salient'].apply(lambda x: 1 if x==True else 0)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3995,"status":"ok","timestamp":1699318656714,"user":{"displayName":"Saadman Khan","userId":"18161026206221029184"},"user_tz":300},"id":"wKjXaPBmI8Us","outputId":"1d686407-b3cb-4420-9344-90cc1dbffb54"},"outputs":[{"output_type":"stream","name":"stderr","text":["<ipython-input-16-f8047ec33545>:2: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  filter_train=filter_train.append(train[train[\"is_salient\"]==1].sample(frac=0.04))\n"]},{"output_type":"execute_result","data":{"text/plain":["584"]},"metadata":{},"execution_count":16}],"source":["filter_train=train.groupby([\"sentence\",\"is_salient\"]).sample(frac=0.04, replace=False)\n","filter_train=filter_train.append(train[train[\"is_salient\"]==1].sample(frac=0.04))\n","len(filter_train)"]},{"cell_type":"code","source":["filter_val=val.groupby([\"sentence\",\"is_salient\"]).sample(frac=0.04, replace=False)\n","filter_val=filter_val.append(val[val[\"is_salient\"]==1].sample(frac=0.04))\n","print(len(filter_val))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"tPIcUWjJSe52","executionInfo":{"status":"ok","timestamp":1699320665506,"user_tz":300,"elapsed":515,"user":{"displayName":"Saadman Khan","userId":"18161026206221029184"}},"outputId":"8f142e7d-82f6-41d2-b9dd-08e1aa07ad3b"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["65\n"]},{"output_type":"stream","name":"stderr","text":["<ipython-input-27-a7062e5f74d1>:2: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  filter_val=filter_val.append(val[val[\"is_salient\"]==1].sample(frac=0.04))\n"]}]},{"cell_type":"code","source":["filter_test=test.groupby([\"sentence\",\"is_salient\"]).sample(frac=0.04, replace=False)\n","filter_test=filter_test.append(test[test[\"is_salient\"]==1].sample(frac=0.04))\n","print(len(filter_test))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4x5Ni8H-ZmzD","executionInfo":{"status":"ok","timestamp":1699320666584,"user_tz":300,"elapsed":268,"user":{"displayName":"Saadman Khan","userId":"18161026206221029184"}},"outputId":"1255bb07-2362-4b2b-cfc9-184ba1377fae"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["66\n"]},{"output_type":"stream","name":"stderr","text":["<ipython-input-28-5d4b4bab9c30>:2: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n","  filter_test=filter_test.append(test[test[\"is_salient\"]==1].sample(frac=0.04))\n"]}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"E4AU8MAHJBgZ"},"outputs":[],"source":["filter_train.dropna(inplace=True)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"jFXGtWdjJQjb","executionInfo":{"status":"ok","timestamp":1699320383392,"user_tz":300,"elapsed":287302,"user":{"displayName":"Saadman Khan","userId":"18161026206221029184"}},"outputId":"99fb8a44-503e-4236-950b-8d7b2bacfb52"},"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/2\n","3/3 [==============================] - 148s 42s/step - loss: 1.3098 - accuracy: 0.4615\n","Epoch 2/2\n","3/3 [==============================] - 139s 40s/step - loss: 0.6911 - accuracy: 0.5513\n"]},{"output_type":"execute_result","data":{"text/plain":["<keras.src.callbacks.History at 0x7dc213d075b0>"]},"metadata":{},"execution_count":25}],"source":["NN_model.fit(filter_train[\"sentence\"],filter_train[eval],epochs=2)"]},{"cell_type":"code","source":["NN_model.evaluate(filter_val[\"sentence\"],filter_val[eval])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"0JlrJSX2SWct","executionInfo":{"status":"ok","timestamp":1699320651969,"user_tz":300,"elapsed":262351,"user":{"displayName":"Saadman Khan","userId":"18161026206221029184"}},"outputId":"8700c3eb-c23d-4e3d-e191-0ca20c5a3c71"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["14/14 [==============================] - 228s 16s/step - loss: 0.4178 - accuracy: 0.9763\n"]},{"output_type":"execute_result","data":{"text/plain":["[0.41779735684394836, 0.9763033390045166]"]},"metadata":{},"execution_count":26}]},{"cell_type":"code","source":["NN_model.evaluate(filter_test[\"sentence\"],filter_test[eval])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"eNbYuQ2KZ8uD","executionInfo":{"status":"ok","timestamp":1699320735277,"user_tz":300,"elapsed":41125,"user":{"displayName":"Saadman Khan","userId":"18161026206221029184"}},"outputId":"78d02b74-fbfb-4fdc-902e-8ee8bdc9777e"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["3/3 [==============================] - 37s 9s/step - loss: 0.5188 - accuracy: 0.8333\n"]},{"output_type":"execute_result","data":{"text/plain":["[0.5187957882881165, 0.8333333134651184]"]},"metadata":{},"execution_count":29}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PwDeh9TRINEt","colab":{"base_uri":"https://localhost:8080/","height":199},"executionInfo":{"status":"error","timestamp":1699319946630,"user_tz":300,"elapsed":383,"user":{"displayName":"Saadman Khan","userId":"18161026206221029184"}},"outputId":"66c7b256-e2bd-4c2a-cda7-159ad000ad98"},"outputs":[{"output_type":"error","ename":"NameError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-23-da1ca0c2f59c>\u001b[0m in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mcm\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mconfusion_matrix\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mX_val\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mmetric\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my_pred\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;31m#Rows Predicted Values and Columns are True Values\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      2\u001b[0m \u001b[0mdisp\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mConfusionMatrixDisplay\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mconfusion_matrix\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mcm\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0mdisplay_labels\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mclf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mclasses_\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;31m#I think we can adjust the working of our labels\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mNameError\u001b[0m: name 'confusion_matrix' is not defined"]}],"source":["cm=confusion_matrix(X_val[metric], y_pred) #Rows Predicted Values and Columns are True Values\n","disp = ConfusionMatrixDisplay(confusion_matrix=cm,display_labels=clf.classes_)#I think we can adjust the working of our labels\n"]}],"metadata":{"accelerator":"TPU","colab":{"provenance":[{"file_id":"1JGRAS_iTKDMLbo0nf6TppZi599vDTkr7","timestamp":1701813638144}]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"3013cd8850b848cba6b5693f1611b572":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_88b38d52a2ea49b280c32e971558cb40","IPY_MODEL_c956356f268243858edaba5884af1853","IPY_MODEL_e20e7b78d9d740aa9d5b2d0de0ad2aea"],"layout":"IPY_MODEL_11319b6f9b12406494598e93f46b672f"}},"88b38d52a2ea49b280c32e971558cb40":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f65da70ec2a0427eb5e4c6768b0f0026","placeholder":"​","style":"IPY_MODEL_4643f08476844ec3beca96cf1a084b4f","value":"Downloading (…)okenizer_config.json: 100%"}},"c956356f268243858edaba5884af1853":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_ed7335f550024a0488811b766ea8726f","max":28,"min":0,"orientation":"horizontal","style":"IPY_MODEL_f25aca113c454a6b874b8508a6cec164","value":28}},"e20e7b78d9d740aa9d5b2d0de0ad2aea":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a7db4b24eadb42808b5ee227403ed7c7","placeholder":"​","style":"IPY_MODEL_d76d10f2860f450da1a2d8f819fd9906","value":" 28.0/28.0 [00:00&lt;00:00, 644B/s]"}},"11319b6f9b12406494598e93f46b672f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f65da70ec2a0427eb5e4c6768b0f0026":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4643f08476844ec3beca96cf1a084b4f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ed7335f550024a0488811b766ea8726f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f25aca113c454a6b874b8508a6cec164":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"a7db4b24eadb42808b5ee227403ed7c7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d76d10f2860f450da1a2d8f819fd9906":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3162abe71aa84848af6761501a2ce4c7":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_c9b1ec9dc8bb431394bde2d39afcc7cb","IPY_MODEL_f0fecf73d7644712a07929c38ecbe9e5","IPY_MODEL_d076824be72349f8ad55f6cf4dcde84c"],"layout":"IPY_MODEL_e25a689ce3624a3c86fbf10a937717cc"}},"c9b1ec9dc8bb431394bde2d39afcc7cb":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_560f713b4a5d43a5925b1659cb31a486","placeholder":"​","style":"IPY_MODEL_5e25d15953084e0e817c4e2cacea19cd","value":"Downloading (…)solve/main/vocab.txt: 100%"}},"f0fecf73d7644712a07929c38ecbe9e5":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_99838cf65d564f6c8dd29bb547110697","max":231508,"min":0,"orientation":"horizontal","style":"IPY_MODEL_30c2d4b1686849658eb0134f010b8648","value":231508}},"d076824be72349f8ad55f6cf4dcde84c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e7017e4b317d4e4d86535052b7c0ffc7","placeholder":"​","style":"IPY_MODEL_4f1852fad35640ffa764a2ff033925d1","value":" 232k/232k [00:00&lt;00:00, 2.30MB/s]"}},"e25a689ce3624a3c86fbf10a937717cc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"560f713b4a5d43a5925b1659cb31a486":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5e25d15953084e0e817c4e2cacea19cd":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"99838cf65d564f6c8dd29bb547110697":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"30c2d4b1686849658eb0134f010b8648":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"e7017e4b317d4e4d86535052b7c0ffc7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4f1852fad35640ffa764a2ff033925d1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"917781504507451abb520a6427c54d37":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_4b23d92ee64e486d8c65eaaa3b92354d","IPY_MODEL_9ae0ce60ac70473ca4cb989984ae27ea","IPY_MODEL_73384dd6893f417b87d8160134bfeada"],"layout":"IPY_MODEL_309e98a8ad5c40d182776b41886bdf59"}},"4b23d92ee64e486d8c65eaaa3b92354d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3125fd961353453e8b2ea404cb98aa4e","placeholder":"​","style":"IPY_MODEL_89a266a11d004c5c8f17a3c2ba0ef535","value":"Downloading (…)/main/tokenizer.json: 100%"}},"9ae0ce60ac70473ca4cb989984ae27ea":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_4384503923544080bc7b95e8090a519d","max":466062,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ce642b795bc94df982a82a184f517a2b","value":466062}},"73384dd6893f417b87d8160134bfeada":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_60f3294883c6485790d3a6cc6327d9d9","placeholder":"​","style":"IPY_MODEL_3f8db8c85c5449b0b2392d56c2ce97e3","value":" 466k/466k [00:00&lt;00:00, 5.34MB/s]"}},"309e98a8ad5c40d182776b41886bdf59":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3125fd961353453e8b2ea404cb98aa4e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"89a266a11d004c5c8f17a3c2ba0ef535":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4384503923544080bc7b95e8090a519d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ce642b795bc94df982a82a184f517a2b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"60f3294883c6485790d3a6cc6327d9d9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3f8db8c85c5449b0b2392d56c2ce97e3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b5695f25ffa3423683d2c70cba0cb142":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_2711e12d2ed04f68acd1bc4930b61c53","IPY_MODEL_d617fcccf1314394aee72f69af87776f","IPY_MODEL_a203cc6030e346298f20c2eb2e76f28a"],"layout":"IPY_MODEL_fb7fb3cafbd5485f8aed6b6722664351"}},"2711e12d2ed04f68acd1bc4930b61c53":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_af68892a6d2e4290ac826c49be891c26","placeholder":"​","style":"IPY_MODEL_f33ba0ed28434479b12f6a3e942e74f3","value":"Downloading (…)lve/main/config.json: 100%"}},"d617fcccf1314394aee72f69af87776f":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_da80481326a1478e9b2e16c39bdfbec1","max":570,"min":0,"orientation":"horizontal","style":"IPY_MODEL_0665fa473ae34fa4a3b6c89179f9370f","value":570}},"a203cc6030e346298f20c2eb2e76f28a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_9cc62e83dda943dd8da840e128ae3413","placeholder":"​","style":"IPY_MODEL_cc55fcc992b84ba69832840f4cf0f458","value":" 570/570 [00:00&lt;00:00, 21.0kB/s]"}},"fb7fb3cafbd5485f8aed6b6722664351":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"af68892a6d2e4290ac826c49be891c26":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f33ba0ed28434479b12f6a3e942e74f3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"da80481326a1478e9b2e16c39bdfbec1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0665fa473ae34fa4a3b6c89179f9370f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"9cc62e83dda943dd8da840e128ae3413":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cc55fcc992b84ba69832840f4cf0f458":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"db313761785d43e3a602164f3ef31f24":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_e69d02969c98482cb375d9580c223a75","IPY_MODEL_069679084e6148bf852638efb0429a4f","IPY_MODEL_ac013c2d7bcd43db92c6a64918e8798b"],"layout":"IPY_MODEL_89337f0c17ed420f9562620d83befadc"}},"e69d02969c98482cb375d9580c223a75":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_42a9166268cf48e5b6ce1dd2e54a76ae","placeholder":"​","style":"IPY_MODEL_245a3316775f42a6a144b99726c6abe8","value":"Downloading model.safetensors: 100%"}},"069679084e6148bf852638efb0429a4f":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_c0f256dc39ac4444bf9d5850d0c46365","max":440449768,"min":0,"orientation":"horizontal","style":"IPY_MODEL_52635b0afb8f4a238fdc996f6b6b23ae","value":440449768}},"ac013c2d7bcd43db92c6a64918e8798b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_92520ef49f874f18843cab49bebbbb07","placeholder":"​","style":"IPY_MODEL_72a0cbffecf749f5aa8078ec5f6d3729","value":" 440M/440M [00:03&lt;00:00, 138MB/s]"}},"89337f0c17ed420f9562620d83befadc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"42a9166268cf48e5b6ce1dd2e54a76ae":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"245a3316775f42a6a144b99726c6abe8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c0f256dc39ac4444bf9d5850d0c46365":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"52635b0afb8f4a238fdc996f6b6b23ae":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"92520ef49f874f18843cab49bebbbb07":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"72a0cbffecf749f5aa8078ec5f6d3729":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"nbformat":4,"nbformat_minor":0}